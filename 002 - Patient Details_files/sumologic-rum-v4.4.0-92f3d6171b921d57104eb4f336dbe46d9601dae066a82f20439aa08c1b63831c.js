!function(e){"use strict";function t(e,t,n,r=!1){var s;const i=Fe[Ge]=null!==(s=Fe[Ge])&&void 0!==s?s:{version:Be};if(!r&&i[e]){const t=new Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return n.error(t.stack||t.message),!1}if(i.version!==Be){const e=new Error("@opentelemetry/api: All API registration versions must match");return n.error(e.stack||e.message),!1}return i[e]=t,n.debug(`@opentelemetry/api: Registered a global for ${e} v${Be}.`),!0}function n(e){var t,n;const r=null===(t=Fe[Ge])||void 0===t?void 0:t.version;if(r&&He(r))return null===(n=Fe[Ge])||void 0===n?void 0:n[e]}function r(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${Be}.`);const n=Fe[Ge];n&&delete n[e]}function s(e,t,r){const s=n("diag");if(s)return r.unshift(t),s[e](...r)}function i(e={}){return new $e(new Map(Object.entries(e)))}function o(e){return"string"!=typeof e&&(ze.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:We,toString:()=>e}}function a(e){return Symbol.for(e)}function c(e){return e.getValue(ft)||void 0}function u(){return c(_t.getInstance().active())}function l(e,t){return e.setValue(ft,t)}function d(e){return e.deleteValue(ft)}function _(e,t){return l(e,new mt(t))}function E(e){var t;return null===(t=c(e))||void 0===t?void 0:t.spanContext()}function p(e){return gt.test(e)&&e!==ht}function h(e){return St.test(e)&&e!==pt}function T(e){return p(e.traceId)&&h(e.spanId)}function m(e){return new mt(e)}function f(e){return e.getValue(Gt)||void 0}function g(){return f(_t.getInstance().active())}function S(e,t){return e.setValue(Gt,t)}function O(e){return e.deleteValue(Gt)}function R(e){return!0===e.getValue(Qt)}function v(e){const t=e.split(Zt);if(t.length<=0)return;const n=t.shift();if(!n)return;const r=n.split(Jt);if(2!==r.length)return;const s=decodeURIComponent(r[0].trim()),i=decodeURIComponent(r[1].trim());let a;return t.length>0&&(a=o(t.join(Zt))),{key:s,value:i,metadata:a}}function A(e){return"string"!=typeof e||0===e.length?{}:e.split(en).map((e=>v(e))).filter((e=>void 0!==e&&e.value.length>0)).reduce(((e,t)=>(e[t.key]=t.value,e)),{})}function N(e){const t={};if("object"!=typeof e||null==e)return t;for(const[n,r]of Object.entries(e))b(n)?L(r)?Array.isArray(r)?t[n]=r.slice():t[n]=r:xt.warn(`Invalid attribute value set for key: ${n}`):xt.warn(`Invalid attribute key: ${n}`);return t}function b(e){return"string"==typeof e&&e.length>0}function L(e){return null==e||(Array.isArray(e)?function(e){let t;for(const n of e)if(null!=n){if(!t){if(P(n)){t=typeof n;continue}return!1}if(typeof n!==t)return!1}return!0}(e):P(e))}function P(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}function I(e){try{rn(e)}catch(e){}}function C(e){return cn.indexOf(e)>-1}function y(e){return un.indexOf(e)>-1}function w(e){return ln.indexOf(e)>-1}function M(e,t,n){if(void 0===n[e])return;const r=String(n[e]);t[e]="true"===r.toLowerCase()}function D(e,t,n,r=-1/0,s=1/0){if(void 0!==n[e]){const i=Number(n[e]);isNaN(i)||(t[e]=i<r?r:i>s?s:i)}}function U(e,t,n,r=an){const s=n[e];"string"==typeof s&&(t[e]=s.split(r).map((e=>e.trim())))}function x(e,t,n){const r=n[e];if("string"==typeof r){const n=En[r.toUpperCase()];null!=n&&(t[e]=n)}}function B(e){const t={};for(const n in _n){const r=n;if("OTEL_LOG_LEVEL"===r)x(r,t,e);else if(C(r))M(r,t,e);else if(y(r))D(r,t,e);else if(w(r))U(r,t,e);else{const n=e[r];null!=n&&(t[r]=String(n))}}return t}function k(){const e=B(on);return Object.assign({},_n,e)}function H(e){const t=e.length;let n="";for(let r=0;r<t;r+=2){const t=e.substring(r,r+2),s=parseInt(t,16);n+=String.fromCharCode(s)}return btoa(n)}function V(e){return function(){for(let t=0;t<2*e;t++)pn[t]=Math.floor(16*Math.random())+48,pn[t]>=58&&(pn[t]+=39);return String.fromCharCode.apply(null,pn.slice(0,2*e))}}function G(e){const t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*vn)]}function F(){let e=hn.timeOrigin;if("number"!=typeof e){const t=hn;e=t.timing&&t.timing.fetchStart}return e}function j(e){return z(G(F()),G("number"==typeof e?e:hn.now()))}function Y(e){if($(e))return e;if("number"==typeof e)return e<F()?j(e):G(e);if(e instanceof Date)return G(e.getTime());throw TypeError("Invalid input type")}function X(e){return e[0]*An+e[1]}function $(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function W(e){return $(e)||"number"==typeof e||e instanceof Date}function z(e,t){const n=[e[0]+t[0],e[1]+t[1]];return n[1]>=An&&(n[1]-=An,n[0]+=1),n}function q(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||function(e){return null==e?void 0===e?Hn:kn:Wn&&Wn in Object(e)?function(e){const t=$n.call(e,Wn),n=e[Wn];let r=!1;try{e[Wn]=void 0,r=!0}catch(e){}const s=zn.call(e);return r&&(t?e[Wn]=n:delete e[Wn]),s}(e):function(e){return zn.call(e)}(e)}(e)!==Bn)return!1;const t=Fn(e);if(null===t)return!0;const n=$n.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Vn.call(n)===Gn}function K(e){return Z(e)?e.slice():e}function Q(e,t,n=0,r){let s;if(!(n>qn)){if(n++,ne(e)||ne(t)||ee(t))s=K(t);else if(Z(e)){if(s=e.slice(),Z(t))for(let e=0,n=t.length;e<n;e++)s.push(K(t[e]));else if(te(t)){const e=Object.keys(t);for(let n=0,r=e.length;n<r;n++){const r=e[n];s[r]=K(t[r])}}}else if(te(e))if(te(t)){if(!function(e,t){return!(!q(e)||!q(t))}(e,t))return t;s=Object.assign({},e);const i=Object.keys(t);for(let o=0,a=i.length;o<a;o++){const a=i[o],c=t[a];if(ne(c))void 0===c?delete s[a]:s[a]=c;else{const i=s[a],o=c;if(J(e,a,r)||J(t,a,r))delete s[a];else{if(te(i)&&te(o)){const n=r.get(i)||[],s=r.get(o)||[];n.push({obj:e,key:a}),s.push({obj:t,key:a}),r.set(i,n),r.set(o,s)}s[a]=Q(s[a],c,n,r)}}}}else s=t;return s}}function J(e,t,n){const r=n.get(e[t])||[];for(let n=0,s=r.length;n<s;n++){const s=r[n];if(s.key===t&&s.obj===e)return!0}return!1}function Z(e){return Array.isArray(e)}function ee(e){return"function"==typeof e}function te(e){return!ne(e)&&!Z(e)&&!ee(e)&&"object"==typeof e}function ne(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||e instanceof Date||e instanceof RegExp||null===e}function re(e,t){return"string"==typeof t?e===t:!!e.match(t)}function se(e,t){if(!t)return!1;for(const n of t)if(re(e,n))return!0;return!1}function ie(){return{sampler:oe(sr),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:k().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:k().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:k().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:k().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:k().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:k().OTEL_SPAN_EVENT_COUNT_LIMIT}}}function oe(e=k()){switch(e.OTEL_TRACES_SAMPLER){case sn.AlwaysOn:return new tr;case sn.AlwaysOff:return new er;case sn.ParentBasedAlwaysOn:return new nr({root:new tr});case sn.ParentBasedAlwaysOff:return new nr({root:new er});case sn.TraceIdRatio:return new rr(ae(e));case sn.ParentBasedTraceIdRatio:return new nr({root:new rr(ae(e))});default:return xt.error(`OTEL_TRACES_SAMPLER value "${e.OTEL_TRACES_SAMPLER} invalid, defaulting to ${ir}".`),new tr}}function ae(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return xt.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${or}.`),or;const t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(xt.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${or}.`),or):t<0||t>1?(xt.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${or}.`),or):t}function ce(e){var t,n,r,s,i,o,a,c,u,l,d,_;const E=Object.assign({},e.spanLimits),p="undefined"!=typeof process?B(process.env):B(on);return E.attributeCountLimit=null!==(o=null!==(i=null!==(s=null!==(n=null===(t=e.spanLimits)||void 0===t?void 0:t.attributeCountLimit)&&void 0!==n?n:null===(r=e.generalLimits)||void 0===r?void 0:r.attributeCountLimit)&&void 0!==s?s:p.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)&&void 0!==i?i:p.OTEL_ATTRIBUTE_COUNT_LIMIT)&&void 0!==o?o:128,E.attributeValueLengthLimit=null!==(_=null!==(d=null!==(l=null!==(c=null===(a=e.spanLimits)||void 0===a?void 0:a.attributeValueLengthLimit)&&void 0!==c?c:null===(u=e.generalLimits)||void 0===u?void 0:u.attributeValueLengthLimit)&&void 0!==l?l:p.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==d?d:p.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==_?_:dn,Object.assign({},e,{spanLimits:E})}function ue(e){return function(){for(let t=0;t<2*e;t++)lr[t]=Math.floor(16*Math.random())+48,lr[t]>=58&&(lr[t]+=39);return String.fromCharCode.apply(null,lr.slice(0,2*e))}}function le(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function de(e,t){return t in e}function _e(e,t,n){if(de(n,t)&&"number"==typeof n[t])return e.addEvent(t,n[t]),e}function Ee(e,t){_e(e,Tr.FETCH_START,t),_e(e,Tr.DOMAIN_LOOKUP_START,t),_e(e,Tr.DOMAIN_LOOKUP_END,t),_e(e,Tr.CONNECT_START,t),_e(e,Tr.SECURE_CONNECTION_START,t),_e(e,Tr.CONNECT_END,t),_e(e,Tr.REQUEST_START,t),_e(e,Tr.RESPONSE_START,t),_e(e,Tr.RESPONSE_END,t);const n=t[Tr.ENCODED_BODY_SIZE];void 0!==n&&e.setAttribute(Tn.HTTP_RESPONSE_CONTENT_LENGTH,n);const r=t[Tr.DECODED_BODY_SIZE];void 0!==r&&n!==r&&e.setAttribute(Tn.HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED,r)}function pe(e,t,n,r,s=new WeakSet,i){const o=he(e),a=function(e,t,n,r,s,i){const o=X(t),a=X(n);let c=r.filter((t=>{const n=X(Y(t[Tr.FETCH_START])),r=X(Y(t[Tr.RESPONSE_END]));return t.initiatorType.toLowerCase()===(i||"xmlhttprequest")&&t.name===e&&n>=o&&r<=a}));return c.length>0&&(c=c.filter((e=>!s.has(e)))),c}(e=o.toString(),t,n,r,s,i);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const c=function(e){return e.slice().sort(((e,t)=>{const n=e[Tr.FETCH_START],r=t[Tr.FETCH_START];return n>r?1:n<r?-1:0}))}(a);if(o.origin!==location.origin&&c.length>1){let e=c[0],t=function(e,t,n){const r=X(n),s=X(Y(t));let i,o=e[1];const a=e.length;for(let t=1;t<a;t++){const n=e[t],a=X(Y(n[Tr.FETCH_START])),c=r-X(Y(n[Tr.RESPONSE_END]));a>=s&&(!i||c<i)&&(i=c,o=n)}return o}(c,e[Tr.RESPONSE_END],n);const r=e[Tr.RESPONSE_END];return t[Tr.FETCH_START]<r&&(t=e,e=void 0),{corsPreFlightRequest:e,mainRequest:t}}return{mainRequest:a[0]}}function he(e){if("function"==typeof URL)return new URL(e,location.href);const t=(Sr||(Sr=document.createElement("a")),Sr);return t.href=e,t}function Te(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return"/";const n=function(e,t){const n=e.nodeType,r=function(e){if(!e.parentNode)return 0;const t=[e.nodeType];e.nodeType===Node.CDATA_SECTION_NODE&&t.push(Node.TEXT_NODE);let n=Array.from(e.parentNode.childNodes);return n=n.filter((n=>{const r=n.localName;return t.indexOf(n.nodeType)>=0&&r===e.localName})),n.length>=1?n.indexOf(e)+1:0}(e);let s="";if(n===Node.ELEMENT_NODE){const n=e.getAttribute("id");if(t&&n)return`//*[@id="${n}"]`;s=e.localName}else if(n===Node.TEXT_NODE||n===Node.CDATA_SECTION_NODE)s="text()";else{if(n!==Node.COMMENT_NODE)return"";s="comment()"}return s&&r>1?`/${s}[${r}]`:`/${s}`}(e,t);if(t&&n.indexOf("@id")>0)return n;let r="";return e.parentNode&&(r+=Te(e.parentNode,!1)),r+=n,r}function me(e,t){let n=t||[];return("string"==typeof n||n instanceof RegExp)&&(n=[n]),he(e).origin===location.origin||n.some((t=>re(e,t)))}function fe(e=[]){let t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];if(Array.isArray(r)){const e=fe(r);t=t.concat(e.instrumentations)}else"function"==typeof r?t.push(new r):r.instrumentationName&&t.push(r)}return{instrumentations:t}}function ge(e){const{instrumentations:t}=fe(e.instrumentations),n=e.tracerProvider||zt.getTracerProvider(),r=e.meterProvider||Vt.getMeterProvider();return function(e,t,n){for(let r=0,s=e.length;r<s;r++){const s=e[r];t&&s.setTracerProvider(t),n&&s.setMeterProvider(n),s.getConfig().enabled||s.enable()}}(t,n,r),()=>{!function(e){e.forEach((e=>e.disable()))}(t)}}function Se(e){return"function"==typeof e}function Oe(e,t,n){var r=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:r,writable:!0,value:n})}function Re(e){e&&e.logger&&(Se(e.logger)?Or=e.logger:Or("new logger isn't a function, not replacing"))}function ve(e,t,n){if(e&&e[t]){if(!n)return Or("no wrapper function"),void Or((new Error).stack);if(Se(e[t])&&Se(n)){var r=e[t],s=n(r,t);return Oe(s,"__original",r),Oe(s,"__unwrap",(function(){e[t]===s&&Oe(e,t,r)})),Oe(s,"__wrapped",!0),Oe(e,t,s),s}Or("original object and wrapper must be functions")}else Or("no original function "+t+" to wrap")}function Ae(e,t){return e&&e[t]?e[t].__unwrap?e[t].__unwrap():void Or("no original to unwrap to -- has "+t+" already been unwrapped?"):(Or("no function to unwrap."),void Or((new Error).stack))}function Ne(e,t,n){let r,s;try{s=e()}catch(e){r=e}finally{if(t(r,s),r&&!n)throw r;return s}}function be(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}function Le(){return!1}function Pe(e){return"number"==typeof e?e<=0?Ie(e,ks):e:function(){var e;const t=Number(null!==(e=k().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT)&&void 0!==e?e:k().OTEL_EXPORTER_OTLP_TIMEOUT);return t<=0?Ie(t,ks):t}()}function Ie(e,t){return xt.warn("Timeout must be greater than 0",e),t}function Ce(e){return Object.keys(e).map((t=>ye(t,e[t])))}function ye(e,t){return{key:e,value:we(t)}}function we(e){const t=typeof e;return"string"===t?{stringValue:e}:"number"===t?Number.isInteger(e)?{intValue:e}:{doubleValue:e}:"boolean"===t?{boolValue:e}:e instanceof Uint8Array?{bytesValue:e}:Array.isArray(e)?{arrayValue:{values:e.map(we)}}:"object"===t&&null!=e?{kvlistValue:{values:Object.entries(e).map((([e,t])=>ye(e,t)))}}:{}}function Me(e,t){const n=e.spanContext(),r=e.status,s=t?e.parentSpanId:null!=e.parentSpanId?H(e.parentSpanId):void 0;return{traceId:t?n.traceId:H(n.traceId),spanId:t?n.spanId:H(n.spanId),parentSpanId:s,name:e.name,kind:null==e.kind?0:e.kind+1,startTimeUnixNano:X(e.startTime),endTimeUnixNano:X(e.endTime),attributes:Ce(e.attributes),droppedAttributesCount:0,events:e.events.map(De),droppedEventsCount:0,status:{code:r.code,message:r.message},links:e.links.map((e=>function(e,t){return{attributes:e.attributes?Ce(e.attributes):[],spanId:t?e.context.spanId:H(e.context.spanId),traceId:t?e.context.traceId:H(e.context.traceId),droppedAttributesCount:0}}(e,t))),droppedLinksCount:0}}function De(e){return{attributes:e.attributes?Ce(e.attributes):[],name:e.name,timeUnixNano:X(e.time),droppedAttributesCount:0}}function Ue(e,t){const n=function(e){const t=new Map;for(const n of e){let e=t.get(n.resource);e||(e=new Map,t.set(n.resource,e));const r=`${n.instrumentationLibrary.name}@${n.instrumentationLibrary.version||""}:${n.instrumentationLibrary.schemaUrl||""}`;let s=e.get(r);s||(s=[],e.set(r,s)),s.push(n)}return t}(e),r=[],s=n.entries();let i=s.next();for(;!i.done;){const[e,n]=i.value,o=[],a=n.values();let c=a.next();for(;!c.done;){const e=c.value;if(e.length>0){const{name:n,version:r,schemaUrl:s}=e[0].instrumentationLibrary,i=e.map((e=>Me(e,t)));o.push({scope:{name:n,version:r},spans:i,schemaUrl:s})}c=a.next()}const u={resource:{attributes:Ce(e.attributes),droppedAttributesCount:0},scopeSpans:o,schemaUrl:void 0};r.push(u),i=s.next()}return r}const xe="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Be="1.4.0",ke=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,He=function(e){function t(e){return s.add(e),!1}function n(e){return r.add(e),!0}const r=new Set([e]),s=new Set,i=e.match(ke);if(!i)return()=>!1;const o=+i[1],a=+i[2],c=+i[3];return null!=i[4]?function(t){return t===e}:function(e){if(r.has(e))return!0;if(s.has(e))return!1;const i=e.match(ke);if(!i)return t(e);const u=+i[1],l=+i[2],d=+i[3];return null!=i[4]||o!==u?t(e):0===o?a===l&&c<=d?n(e):t(e):a<=l?n(e):t(e)}}(Be),Ve=Be.split(".")[0],Ge=Symbol.for(`opentelemetry.js.api.${Ve}`),Fe=xe;class je{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return s("debug",this._namespace,e)}error(...e){return s("error",this._namespace,e)}info(...e){return s("info",this._namespace,e)}warn(...e){return s("warn",this._namespace,e)}verbose(...e){return s("verbose",this._namespace,e)}}var Ye;!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(Ye||(Ye={}));class Xe{constructor(){function e(e){return function(...t){const r=n("diag");if(r)return r[e](...t)}}const s=this;s.setLogger=(e,r={logLevel:Ye.INFO})=>{var i,o,a;if(e===s){const e=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return s.error(null!==(i=e.stack)&&void 0!==i?i:e.message),!1}"number"==typeof r&&(r={logLevel:r});const c=n("diag"),u=function(e,t){function n(n,r){const s=t[n];return"function"==typeof s&&e>=r?s.bind(t):function(){}}return e<Ye.NONE?e=Ye.NONE:e>Ye.ALL&&(e=Ye.ALL),t=t||{},{error:n("error",Ye.ERROR),warn:n("warn",Ye.WARN),info:n("info",Ye.INFO),debug:n("debug",Ye.DEBUG),verbose:n("verbose",Ye.VERBOSE)}}(null!==(o=r.logLevel)&&void 0!==o?o:Ye.INFO,e);if(c&&!r.suppressOverrideMessage){const e=null!==(a=(new Error).stack)&&void 0!==a?a:"<failed to generate stacktrace>";c.warn(`Current logger will be overwritten from ${e}`),u.warn(`Current logger will overwrite one already registered from ${e}`)}return t("diag",u,s,!0)},s.disable=()=>{r("diag",s)},s.createComponentLogger=e=>new je(e),s.verbose=e("verbose"),s.debug=e("debug"),s.info=e("info"),s.warn=e("warn"),s.error=e("error")}static instance(){return this._instance||(this._instance=new Xe),this._instance}}class $e{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){const t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map((([e,t])=>[e,t]))}setEntry(e,t){const n=new $e(this._entries);return n._entries.set(e,t),n}removeEntry(e){const t=new $e(this._entries);return t._entries.delete(e),t}removeEntries(...e){const t=new $e(this._entries);for(const n of e)t._entries.delete(n);return t}clear(){return new $e}}const We=Symbol("BaggageEntryMetadata"),ze=Xe.instance();class qe{constructor(e){const t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,n)=>{const r=new qe(t._currentContext);return r._currentContext.set(e,n),r},t.deleteValue=e=>{const n=new qe(t._currentContext);return n._currentContext.delete(e),n}}}const Ke=new qe,Qe=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class Je{}class Ze{addCallback(e){}removeCallback(e){}}const et=new class{constructor(){}createHistogram(e,t){return nt}createCounter(e,t){return tt}createUpDownCounter(e,t){return rt}createObservableGauge(e,t){return it}createObservableCounter(e,t){return st}createObservableUpDownCounter(e,t){return ot}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}},tt=new class extends Je{add(e,t){}},nt=new class extends Je{record(e,t){}},rt=new class extends Je{add(e,t){}},st=new class extends Ze{},it=new class extends Ze{},ot=new class extends Ze{};var at;!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(at||(at={}));const ct={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},ut={set(e,t,n){null!=e&&(e[t]=n)}},lt="context",dt=new class{active(){return Ke}with(e,t,n,...r){return t.call(n,...r)}bind(e,t){return t}enable(){return this}disable(){return this}};class _t{constructor(){}static getInstance(){return this._instance||(this._instance=new _t),this._instance}setGlobalContextManager(e){return t(lt,e,Xe.instance())}active(){return this._getContextManager().active()}with(e,t,n,...r){return this._getContextManager().with(e,t,n,...r)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return n(lt)||dt}disable(){this._getContextManager().disable(),r(lt,Xe.instance())}}var Et;!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(Et||(Et={}));const pt="0000000000000000",ht="00000000000000000000000000000000",Tt={traceId:ht,spanId:pt,traceFlags:Et.NONE};class mt{constructor(e=Tt){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}const ft=a("OpenTelemetry Context Key SPAN"),gt=/^([0-9a-f]{32})$/i,St=/^[0-9a-f]{16}$/i,Ot=_t.getInstance();class Rt{startSpan(e,t,n=Ot.active()){if(Boolean(null==t?void 0:t.root))return new mt;const r=n&&E(n);return"object"==typeof(s=r)&&"string"==typeof s.spanId&&"string"==typeof s.traceId&&"number"==typeof s.traceFlags&&T(r)?new mt(r):new mt;var s}startActiveSpan(e,t,n,r){let s,i,o;if(arguments.length<2)return;2===arguments.length?o=t:3===arguments.length?(s=t,o=n):(s=t,i=n,o=r);const a=null!=i?i:Ot.active(),c=this.startSpan(e,s,a),u=l(a,c);return Ot.with(u,o,void 0,c)}}const vt=new Rt;class At{constructor(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}startSpan(e,t,n){return this._getTracer().startSpan(e,t,n)}startActiveSpan(e,t,n,r){const s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)}_getTracer(){if(this._delegate)return this._delegate;const e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):vt}}const Nt=new class{getTracer(e,t,n){return new Rt}};class bt{getTracer(e,t,n){var r;return null!==(r=this.getDelegateTracer(e,t,n))&&void 0!==r?r:new At(this,e,t,n)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:Nt}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)}}var Lt,Pt,It;!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Lt||(Lt={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(Pt||(Pt={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(It||(It={}));const Ct="[_0-9a-z-*/]",yt=new RegExp(`^(?:[a-z]${Ct}{0,255}|[a-z0-9]${Ct}{0,240}@[a-z]${Ct}{0,13})$`),wt=/^[ -~]{0,255}[!-~]$/,Mt=/,|=/;class Dt{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){const n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n}unset(e){const t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce(((e,t)=>(e.push(t+"="+this.get(t)),e)),[]).join(",")}_parse(e){e.length>512||(this._internalState=e.split(",").reverse().reduce(((e,t)=>{const n=t.trim(),r=n.indexOf("=");if(-1!==r){const s=n.slice(0,r),i=n.slice(r+1,t.length);(function(e){return yt.test(e)})(s)&&function(e){return wt.test(e)&&!Mt.test(e)}(i)&&e.set(s,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const e=new Dt;return e._internalState=new Map(this._internalState),e}}const Ut=_t.getInstance(),xt=Xe.instance(),Bt=new class{getMeter(e,t,n){return et}},kt="metrics";class Ht{constructor(){}static getInstance(){return this._instance||(this._instance=new Ht),this._instance}setGlobalMeterProvider(e){return t(kt,e,Xe.instance())}getMeterProvider(){return n(kt)||Bt}getMeter(e,t,n){return this.getMeterProvider().getMeter(e,t,n)}disable(){r(kt,Xe.instance())}}const Vt=Ht.getInstance(),Gt=a("OpenTelemetry Baggage Key"),Ft="propagation",jt=new class{inject(e,t){}extract(e,t){return e}fields(){return[]}};class Yt{constructor(){this.createBaggage=i,this.getBaggage=f,this.getActiveBaggage=g,this.setBaggage=S,this.deleteBaggage=O}static getInstance(){return this._instance||(this._instance=new Yt),this._instance}setGlobalPropagator(e){return t(Ft,e,Xe.instance())}inject(e,t,n=ut){return this._getGlobalPropagator().inject(e,t,n)}extract(e,t,n=ct){return this._getGlobalPropagator().extract(e,t,n)}fields(){return this._getGlobalPropagator().fields()}disable(){r(Ft,Xe.instance())}_getGlobalPropagator(){return n(Ft)||jt}}const Xt=Yt.getInstance(),$t="trace";class Wt{constructor(){this._proxyTracerProvider=new bt,this.wrapSpanContext=m,this.isSpanContextValid=T,this.deleteSpan=d,this.getSpan=c,this.getActiveSpan=u,this.getSpanContext=E,this.setSpan=l,this.setSpanContext=_}static getInstance(){return this._instance||(this._instance=new Wt),this._instance}setGlobalTracerProvider(e){const n=t($t,this._proxyTracerProvider,Xe.instance());return n&&this._proxyTracerProvider.setDelegate(e),n}getTracerProvider(){return n($t)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){r($t,Xe.instance()),this._proxyTracerProvider=new bt}}const zt=Wt.getInstance();var qt={context:Ut,diag:xt,metrics:Vt,propagation:Xt,trace:zt},Kt=Object.freeze({__proto__:null,context:Ut,diag:xt,metrics:Vt,propagation:Xt,trace:zt,default:qt,baggageEntryMetadataFromString:o,createContextKey:a,ROOT_CONTEXT:Ke,DiagConsoleLogger:class{constructor(){function e(e){return function(...t){if(console){let n=console[e];if("function"!=typeof n&&(n=console.log),"function"==typeof n)return n.apply(console,t)}}}for(let t=0;t<Qe.length;t++)this[Qe[t].n]=e(Qe[t].c)}},get DiagLogLevel(){return Ye},createNoopMeter:function(){return et},get ValueType(){return at},defaultTextMapGetter:ct,defaultTextMapSetter:ut,ProxyTracer:At,ProxyTracerProvider:bt,get SamplingDecision(){return Lt},get SpanKind(){return Pt},get SpanStatusCode(){return It},get TraceFlags(){return Et},createTraceState:function(e){return new Dt(e)},isSpanContextValid:T,isValidTraceId:p,isValidSpanId:h,INVALID_SPANID:pt,INVALID_TRACEID:ht,INVALID_SPAN_CONTEXT:Tt});const Qt=a("OpenTelemetry SDK Context Key SUPPRESS_TRACING"),Jt="=",Zt=";",en=",",tn="baggage";class nn{inject(e,t,n){const r=Xt.getBaggage(e);if(!r||R(e))return;const s=function(e){return e.getAllEntries().map((([e,t])=>{let n=`${encodeURIComponent(e)}=${encodeURIComponent(t.value)}`;return void 0!==t.metadata&&(n+=Zt+t.metadata.toString()),n}))}(r).filter((e=>e.length<=4096)).slice(0,180),i=function(e){return e.reduce(((e,t)=>{const n=`${e}${""!==e?en:""}${t}`;return n.length>8192?e:n}),"")}(s);i.length>0&&n.set(t,tn,i)}extract(e,t,n){const r=n.get(t,tn),s=Array.isArray(r)?r.join(en):r;if(!s)return e;const i={};return 0===s.length?e:(s.split(en).forEach((e=>{const t=v(e);if(t){const e={value:t.value};t.metadata&&(e.metadata=t.metadata),i[t.key]=e}})),0===Object.entries(i).length?e:Xt.setBaggage(e,Xt.createBaggage(i)))}fields(){return[tn]}}let rn=e=>{xt.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){const t={};let n=e;for(;null!==n;)Object.getOwnPropertyNames(n).forEach((e=>{if(t[e])return;const r=n[e];r&&(t[e]=String(r))})),n=Object.getPrototypeOf(n);return t}(e))}(e))};var sn;!function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"}(sn||(sn={}));const on="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},an=",",cn=["OTEL_SDK_DISABLED"],un=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"],ln=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"],dn=1/0,_n={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:Ye.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:dn,OTEL_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:dn,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:sn.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"},En={ALL:Ye.ALL,VERBOSE:Ye.VERBOSE,DEBUG:Ye.DEBUG,INFO:Ye.INFO,WARN:Ye.WARN,ERROR:Ye.ERROR,NONE:Ye.NONE},pn=Array(32),hn=performance,Tn={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",
CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},mn="deployment.environment",fn="service.name",gn="telemetry.sdk.name",Sn="telemetry.sdk.language",On="telemetry.sdk.version",Rn={[gn]:"opentelemetry","process.runtime.name":"browser",[Sn]:"webjs",[On]:"1.9.0"},vn=Math.pow(10,6),An=Math.pow(10,9);var Nn;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(Nn||(Nn={}));class bn{constructor(e={}){var t;this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((e=>"function"==typeof e.fields?e.fields():[])).reduce(((e,t)=>e.concat(t)),[])))}inject(e,t,n){for(const r of this._propagators)try{r.inject(e,t,n)}catch(e){xt.warn(`Failed to inject with ${r.constructor.name}. Err: ${e.message}`)}}extract(e,t,n){return this._propagators.reduce(((e,r)=>{try{return r.extract(e,t,n)}catch(e){xt.warn(`Failed to inject with ${r.constructor.name}. Err: ${e.message}`)}return e}),e)}fields(){return this._fields.slice()}}const Ln="[_0-9a-z-*/]",Pn=new RegExp(`^(?:[a-z]${Ln}{0,255}|[a-z0-9]${Ln}{0,240}@[a-z]${Ln}{0,13})$`),In=/^[ -~]{0,255}[!-~]$/,Cn=/,|=/;class yn{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){const n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n}unset(e){const t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce(((e,t)=>(e.push(t+"="+this.get(t)),e)),[]).join(",")}_parse(e){e.length>512||(this._internalState=e.split(",").reverse().reduce(((e,t)=>{const n=t.trim(),r=n.indexOf("=");if(-1!==r){const s=n.slice(0,r),i=n.slice(r+1,t.length);(function(e){return Pn.test(e)})(s)&&function(e){return In.test(e)&&!Cn.test(e)}(i)&&e.set(s,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const e=new yn;return e._internalState=new Map(this._internalState),e}}const wn="traceparent",Mn="tracestate",Dn=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class Un{inject(e,t,n){const r=zt.getSpanContext(e);if(!r||R(e)||!T(r))return;const s=`00-${r.traceId}-${r.spanId}-0${Number(r.traceFlags||Et.NONE).toString(16)}`;n.set(t,wn,s),r.traceState&&n.set(t,Mn,r.traceState.serialize())}extract(e,t,n){const r=n.get(t,wn);if(!r)return e;const s=Array.isArray(r)?r[0]:r;if("string"!=typeof s)return e;const i=function(e){const t=Dn.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}(s);if(!i)return e;i.isRemote=!0;const o=n.get(t,Mn);if(o){const e=Array.isArray(o)?o.join(","):o;i.traceState=new yn("string"==typeof e?e:void 0)}return zt.setSpanContext(e,i)}fields(){return[wn,Mn]}}var xn;!function(e){e.HTTP="http"}(xn||(xn={}));const Bn="[object Object]",kn="[object Null]",Hn="[object Undefined]",Vn=Function.prototype.toString,Gn=Vn.call(Object),Fn=(jn=Object.getPrototypeOf,Yn=Object,function(e){return jn(Yn(e))});var jn,Yn;const Xn=Object.prototype,$n=Xn.hasOwnProperty,Wn=Symbol?Symbol.toStringTag:void 0,zn=Xn.toString,qn=20;class Kn{constructor(){this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}class Qn{constructor(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new Kn}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then((e=>this._deferred.resolve(e)),(e=>this._deferred.reject(e)))}catch(e){this._deferred.reject(e)}}return this._deferred.promise}}class Jn{constructor(e,t,n,r,s,i,o=[],a,c){this.attributes={},this.links=[],this.events=[],this.status={code:It.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=r,this.parentSpanId=i,this.kind=s,this.links=o;const u=Date.now();this._performanceStartTime=hn.now(),this._performanceOffset=u-(this._performanceStartTime+F()),this._startTimeProvided=null!=a,this.startTime=this._getTime(null!=a?a:u),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,t),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}spanContext(){return this._spanContext}setAttribute(e,t){return null==t||this._isSpanEnded()?this:0===e.length?(xt.warn(`Invalid attribute key: ${e}`),this):L(t)?(Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)||(this.attributes[e]=this._truncateToSize(t)),this):(xt.warn(`Invalid attribute value set for key: ${e}`),this)}setAttributes(e){for(const[t,n]of Object.entries(e))this.setAttribute(t,n);return this}addEvent(e,t,n){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return xt.warn("No events allowed."),this;this.events.length>=this._spanLimits.eventCountLimit&&(xt.warn("Dropping extra events."),this.events.shift()),W(t)&&(W(n)||(n=t),t=void 0);const r=N(t);return this.events.push({name:e,attributes:r,time:this._getTime(n)}),this}setStatus(e){return this._isSpanEnded()||(this.status=e),this}updateName(e){return this._isSpanEnded()||(this.name=e),this}end(e){this._isSpanEnded()?xt.error("You can only call end() on a span once."):(this._ended=!0,this.endTime=this._getTime(e),this._duration=function(e,t){let n=t[0]-e[0],r=t[1]-e[1];return r<0&&(n-=1,r+=An),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(xt.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this))}_getTime(e){if("number"==typeof e&&e<hn.now())return j(e+this._performanceOffset);if("number"==typeof e)return G(e);if(e instanceof Date)return G(e.getTime());if($(e))return e;if(this._startTimeProvided)return G(Date.now());const t=hn.now()-this._performanceStartTime;return z(this.startTime,G(t))}isRecording(){return!1===this._ended}recordException(e,t){const n={};"string"==typeof e?n[Tn.EXCEPTION_MESSAGE]=e:e&&(e.code?n[Tn.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[Tn.EXCEPTION_TYPE]=e.name),e.message&&(n[Tn.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[Tn.EXCEPTION_STACKTRACE]=e.stack)),n[Tn.EXCEPTION_TYPE]||n[Tn.EXCEPTION_MESSAGE]?this.addEvent("exception",n,t):xt.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&xt.warn(`Can not execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`),this._ended}_truncateToLimitUtil(e,t){return e.length<=t?e:e.substr(0,t)}_truncateToSize(e){const t=this._attributeValueLengthLimit;return t<=0?(xt.warn(`Attribute value limit must be positive, got ${t}`),e):"string"==typeof e?this._truncateToLimitUtil(e,t):Array.isArray(e)?e.map((e=>"string"==typeof e?this._truncateToLimitUtil(e,t):e)):e}}var Zn;!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Zn||(Zn={}));class er{shouldSample(){return{decision:Zn.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class tr{shouldSample(){return{decision:Zn.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class nr{constructor(e){var t,n,r,s;this._root=e.root,this._root||(I(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new tr),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new tr,this._remoteParentNotSampled=null!==(n=e.remoteParentNotSampled)&&void 0!==n?n:new er,this._localParentSampled=null!==(r=e.localParentSampled)&&void 0!==r?r:new tr,this._localParentNotSampled=null!==(s=e.localParentNotSampled)&&void 0!==s?s:new er}shouldSample(e,t,n,r,s,i){const o=zt.getSpanContext(e);return o&&T(o)?o.isRemote?o.traceFlags&Et.SAMPLED?this._remoteParentSampled.shouldSample(e,t,n,r,s,i):this._remoteParentNotSampled.shouldSample(e,t,n,r,s,i):o.traceFlags&Et.SAMPLED?this._localParentSampled.shouldSample(e,t,n,r,s,i):this._localParentNotSampled.shouldSample(e,t,n,r,s,i):this._root.shouldSample(e,t,n,r,s,i)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}class rr{constructor(e=0){this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(e,t){return{decision:p(t)&&this._accumulate(t)<this._upperBound?Zn.RECORD_AND_SAMPLED:Zn.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let t=0;for(let n=0;n<e.length/8;n++){const r=8*n;t=(t^parseInt(e.slice(r,r+8),16))>>>0}return t}}const sr=k(),ir=sn.AlwaysOn,or=1;class ar{constructor(e,t){this._exporter=e,this._finishedSpans=[];const n=k();this._maxExportBatchSize="number"==typeof(null==t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==t?void 0:t.maxQueueSize)?t.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new Qn(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(xt.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(e,t){}onEnd(e){this._shutdownOnce.isCalled||0!=(e.spanContext().traceFlags&Et.SAMPLED)&&this._addToBuffer(e)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then((()=>this.onShutdown())).then((()=>this._flushAll())).then((()=>this._exporter.shutdown()))}_addToBuffer(e){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(e),this._maybeStartTimer())}_flushAll(){return new Promise(((e,t)=>{const n=[];for(let e=0,t=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);e<t;e++)n.push(this._flushOneBatch());Promise.all(n).then((()=>{e()})).catch(t)}))}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise(((e,t)=>{const n=setTimeout((()=>{t(new Error("Timeout"))}),this._exportTimeoutMillis);Ut.with(function(e){return e.setValue(Qt,!0)}(Ut.active()),(()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),(r=>{var s;clearTimeout(n),r.code===Nn.SUCCESS?e():t(null!==(s=r.error)&&void 0!==s?s:new Error("BatchSpanProcessor: span export failed"))}))}))}))}_maybeStartTimer(){void 0===this._timer&&(this._timer=window.setTimeout((()=>{this._flushOneBatch().then((()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())})).catch((e=>{I(e)}))}),this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}class cr extends ar{constructor(e,t){super(e,t),this.onInit(t)}onInit(e){!0!==(null==e?void 0:e.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush()},this._pageHideListener=()=>{this.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}}class ur{constructor(){this.generateTraceId=ue(16),this.generateSpanId=ue(8)}}const lr=Array(32);class dr{constructor(e,t,n){this._tracerProvider=n;const r=function(e){const t={sampler:oe()},n=ie(),r=Object.assign({},n,t,e);return r.generalLimits=Object.assign({},n.generalLimits,e.generalLimits||{}),r.spanLimits=Object.assign({},n.spanLimits,e.spanLimits||{}),r}(t);this._sampler=r.sampler,this._generalLimits=r.generalLimits,this._spanLimits=r.spanLimits,this._idGenerator=t.idGenerator||new ur,this.resource=n.resource,this.instrumentationLibrary=e}startSpan(e,t={},n=Ut.active()){var r,s;t.root&&(n=zt.deleteSpan(n));const i=zt.getSpan(n);if(R(n))return xt.debug("Instrumentation suppressed, returning Noop Span"),zt.wrapSpanContext(Tt);const o=null==i?void 0:i.spanContext(),a=this._idGenerator.generateSpanId();let c,u,l;o&&zt.isSpanContextValid(o)?(c=o.traceId,u=o.traceState,l=o.spanId):c=this._idGenerator.generateTraceId();const d=null!==(r=t.kind)&&void 0!==r?r:Pt.INTERNAL,_=(null!==(s=t.links)&&void 0!==s?s:[]).map((e=>({context:e.context,attributes:N(e.attributes)}))),E=N(t.attributes),p=this._sampler.shouldSample(n,c,e,d,E,_),h={traceId:c,spanId:a,traceFlags:p.decision===Lt.RECORD_AND_SAMPLED?Et.SAMPLED:Et.NONE,traceState:u};if(p.decision===Lt.NOT_RECORD)return xt.debug("Recording is off, propagating context in a non-recording span"),zt.wrapSpanContext(h);const T=new Jn(this,n,e,h,d,l,_,t.startTime),m=N(Object.assign(E,p.attributes));return T.setAttributes(m),T}startActiveSpan(e,t,n,r){let s,i,o;if(arguments.length<2)return;2===arguments.length?o=t:3===arguments.length?(s=t,o=n):(s=t,i=n,o=r);const a=null!=i?i:Ut.active(),c=this.startSpan(e,s,a),u=zt.setSpan(a,c);return Ut.with(u,o,void 0,c)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}}class _r{constructor(e){this.attributes=e}static empty(){return _r.EMPTY}static default(){return new _r({[fn]:"unknown_service",[Sn]:Rn[Sn],[gn]:Rn[gn],[On]:Rn[On]})}merge(e){if(!e||!Object.keys(e.attributes).length)return this;const t=Object.assign({},this.attributes,e.attributes);return new _r(t)}}_r.EMPTY=new _r({});class Er{constructor(e){this._spanProcessors=e}forceFlush(){const e=[];for(const t of this._spanProcessors)e.push(t.forceFlush());return new Promise((t=>{Promise.all(e).then((()=>{t()})).catch((e=>{I(e||new Error("MultiSpanProcessor: forceFlush failed")),t()}))}))}onStart(e,t){for(const n of this._spanProcessors)n.onStart(e,t)}onEnd(e){for(const t of this._spanProcessors)t.onEnd(e)}shutdown(){const e=[];for(const t of this._spanProcessors)e.push(t.shutdown());return new Promise(((t,n)=>{Promise.all(e).then((()=>{t()}),n)}))}}class pr{onStart(e,t){}onEnd(e){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}}var hr,Tr;!function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"}(hr||(hr={}));class mr{constructor(e={}){var t;this._registeredSpanProcessors=[],this._tracers=new Map;const n=function(...e){let t=e.shift();const n=new WeakMap;for(;e.length>0;)t=Q(t,e.shift(),0,n);return t}({},ie(),ce(e));this.resource=null!==(t=n.resource)&&void 0!==t?t:_r.empty(),this.resource=_r.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});const r=this._buildExporterFromEnv();if(void 0!==r){const e=new cr(r);this.activeSpanProcessor=e}else this.activeSpanProcessor=new pr}getTracer(e,t,n){const r=`${e}@${t||""}:${(null==n?void 0:n.schemaUrl)||""}`;return this._tracers.has(r)||this._tracers.set(r,new dr({name:e,version:t,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this)),this._tracers.get(r)}addSpanProcessor(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((e=>xt.error("Error while trying to shutdown current span processor",e))),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new Er(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(e={}){zt.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Ut.setGlobalContextManager(e.contextManager),e.propagator&&Xt.setGlobalPropagator(e.propagator)}forceFlush(){const e=this._config.forceFlushTimeoutMillis,t=this._registeredSpanProcessors.map((t=>new Promise((n=>{let r;const s=setTimeout((()=>{n(new Error(`Span processor did not completed within timeout period of ${e} ms`)),r=hr.timeout}),e);t.forceFlush().then((()=>{clearTimeout(s),r!==hr.timeout&&(r=hr.resolved,n(r))})).catch((e=>{clearTimeout(s),r=hr.error,n(e)}))}))));return new Promise(((e,n)=>{Promise.all(t).then((t=>{const r=t.filter((e=>e!==hr.resolved));r.length>0?n(r):e()})).catch((e=>n([e])))}))}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(e){var t;return null===(t=this.constructor._registeredPropagators.get(e))||void 0===t?void 0:t()}_getSpanExporter(e){var t;return null===(t=this.constructor._registeredExporters.get(e))||void 0===t?void 0:t()}_buildPropagatorFromEnv(){const e=Array.from(new Set(k().OTEL_PROPAGATORS)),t=e.map((e=>{const t=this._getPropagator(e);return t||xt.warn(`Propagator "${e}" requested through environment variable is unavailable.`),t})).reduce(((e,t)=>(t&&e.push(t),e)),[]);return 0===t.length?void 0:1===e.length?t[0]:new bn({propagators:t})}_buildExporterFromEnv(){const e=k().OTEL_TRACES_EXPORTER;if("none"===e||""===e)return;const t=this._getSpanExporter(e);return t||xt.error(`Exporter "${e}" requested through environment variable is unavailable.`),t}}mr._registeredPropagators=new Map([["tracecontext",()=>new Un],["baggage",()=>new nn]]),mr._registeredExporters=new Map;class fr{constructor(){this._enabled=!1,this._currentContext=Ke}_bindFunction(e=Ke,t){const n=this,r=function(...r){return n.with(e,(()=>t.apply(this,r)))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r}active(){return this._currentContext}bind(e,t){return void 0===e&&(e=this.active()),"function"==typeof t?this._bindFunction(e,t):t}disable(){return this._currentContext=Ke,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=Ke),this}with(e,t,n,...r){const s=this._currentContext;this._currentContext=e||Ke;try{return t.call(n,...r)}finally{this._currentContext=s}}}class gr extends mr{constructor(e={}){if(super(e),e.contextManager)throw"contextManager should be defined in register method not in constructor";if(e.propagator)throw"propagator should be defined in register method not in constructor"}register(e={}){void 0===e.contextManager&&(e.contextManager=new fr),e.contextManager&&e.contextManager.enable(),super.register(e)}}let Sr;!function(e){e.CONNECT_END="connectEnd",e.CONNECT_START="connectStart",e.DECODED_BODY_SIZE="decodedBodySize",e.DOM_COMPLETE="domComplete",e.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",e.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",e.DOM_INTERACTIVE="domInteractive",e.DOMAIN_LOOKUP_END="domainLookupEnd",e.DOMAIN_LOOKUP_START="domainLookupStart",e.ENCODED_BODY_SIZE="encodedBodySize",e.FETCH_START="fetchStart",e.LOAD_EVENT_END="loadEventEnd",e.LOAD_EVENT_START="loadEventStart",e.NAVIGATION_START="navigationStart",e.REDIRECT_END="redirectEnd",e.REDIRECT_START="redirectStart",e.REQUEST_START="requestStart",e.RESPONSE_END="responseEnd",e.RESPONSE_START="responseStart",e.SECURE_CONNECTION_START="secureConnectionStart",e.UNLOAD_EVENT_END="unloadEventEnd",e.UNLOAD_EVENT_START="unloadEventStart"}(Tr||(Tr={}));var Or=console.error.bind(console);Re.wrap=ve,Re.massWrap=function(e,t,n){if(!e)return Or("must provide one or more modules to patch"),void Or((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){ve(e,t,n)}))})):Or("must provide one or more functions to wrap on modules")},Re.unwrap=Ae,Re.massUnwrap=function(e,t){if(!e)return Or("must provide one or more modules to patch"),void Or((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){Ae(e,t)}))})):Or("must provide one or more functions to unwrap on modules")};var Rr,vr=Re;class Ar{constructor(e,t,n={}){this.instrumentationName=e,this.instrumentationVersion=t,this._wrap=vr.wrap,this._unwrap=vr.unwrap,this._massWrap=vr.massWrap,this._massUnwrap=vr.massUnwrap,this._config=Object.assign({enabled:!0},n),this._diag=xt.createComponentLogger({namespace:e}),this._tracer=zt.getTracer(e,t),this._meter=Vt.getMeter(e,t),this._updateMetricInstruments()}get meter(){return this._meter}setMeterProvider(e){this._meter=e.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(e={}){this._config=Object.assign({},e)}setTracerProvider(e){this._tracer=e.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}}class Nr extends Ar{constructor(e,t,n={}){super(e,t,n),this._config.enabled&&this.enable()}}!function(e){e.METHOD_OPEN="open",e.METHOD_SEND="send",e.EVENT_ABORT="abort",e.EVENT_ERROR="error",e.EVENT_LOAD="loaded",e.EVENT_TIMEOUT="timeout"}(Rr||(Rr={}));const br="0.35.0";var Lr,Pr;!function(e){e.HTTP_STATUS_TEXT="http.status_text"}(Lr||(Lr={}));class Ir extends Nr{constructor(e){super("@opentelemetry/instrumentation-xml-http-request",br,e),this.component="xml-http-request",this.version=br,this.moduleName=this.component,this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}init(){}_getConfig(){return this._config}_addHeaders(e,t){if(!me(he(t).href,this._getConfig().propagateTraceHeaderCorsUrls)){const e={};return Xt.inject(Ut.active(),e),void(Object.keys(e).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}const n={};Xt.inject(Ut.active(),n),Object.keys(n).forEach((t=>{e.setRequestHeader(t,String(n[t]))}))}_addChildSpan(e,t){Ut.with(zt.setSpan(Ut.active(),e),(()=>{const e=this.tracer.startSpan("CORS Preflight",{startTime:t[Tr.FETCH_START]});Ee(e,t),e.end(t[Tr.RESPONSE_END])}))}_addFinalSpanAttributes(e,t,n){if("string"==typeof n){const r=he(n);void 0!==t.status&&e.setAttribute(Tn.HTTP_STATUS_CODE,t.status),void 0!==t.statusText&&e.setAttribute(Lr.HTTP_STATUS_TEXT,t.statusText),e.setAttribute(Tn.HTTP_HOST,r.host),e.setAttribute(Tn.HTTP_SCHEME,r.protocol.replace(":","")),e.setAttribute(Tn.HTTP_USER_AGENT,navigator.userAgent)}}_applyAttributesAfterXHR(e,t){const n=this._getConfig().applyCustomAttributesOnSpan;"function"==typeof n&&Ne((()=>n(e,t)),(e=>{e&&this._diag.error("applyCustomAttributesOnSpan",e)}),!0)}_addResourceObserver(e,t){const n=this._xhrMem.get(e);n&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(n.createdResources={observer:new PerformanceObserver((e=>{const r=e.getEntries(),s=he(t);r.forEach((e=>{"xmlhttprequest"===e.initiatorType&&e.name===s.href&&n.createdResources&&n.createdResources.entries.push(e)}))})),entries:[]},n.createdResources.observer.observe({entryTypes:["resource"]}))}_clearResources(){0===this._tasksCount&&this._getConfig().clearTimingResources&&(hn.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)}_findResourceAndAddNetworkEvents(e,t,n,r,s){if(!(n&&r&&s&&e.createdResources))return;let i=e.createdResources.entries;i&&i.length||(i=hn.getEntriesByType("resource"));const o=pe(he(n).href,r,s,i,this._usedResources);if(o.mainRequest){const e=o.mainRequest;this._markResourceAsUsed(e);const n=o.corsPreFlightRequest;n&&(this._addChildSpan(t,n),this._markResourceAsUsed(n)),Ee(t,e)}}_cleanPreviousSpanInformation(e){const t=this._xhrMem.get(e);if(t){const n=t.callbackToRemoveEvents;n&&n(),this._xhrMem.delete(e)}}_createSpan(e,t,n){if(se(t,this._getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");const r=`HTTP ${n.toUpperCase()}`,s=this.tracer.startSpan(r,{kind:Pt.CLIENT,attributes:{[Tn.HTTP_METHOD]:n,[Tn.HTTP_URL]:he(t).toString()}});return s.addEvent(Rr.METHOD_OPEN),this._cleanPreviousSpanInformation(e),this._xhrMem.set(e,{span:s,spanUrl:t}),s}_markResourceAsUsed(e){this._usedResources.add(e)}_patchOpen(){return e=>{const t=this;return function(...n){const r=n[0],s=n[1];return t._createSpan(this,s,r),e.apply(this,n)}}}_patchSend(){function e(e,t){const n=i._xhrMem.get(t);if(!n)return;n.status=t.status,n.statusText=t.statusText,i._xhrMem.delete(t),n.span&&i._applyAttributesAfterXHR(n.span,t);const r=j(),s=Date.now();setTimeout((()=>{!function(e,t,n,r){const s=t.callbackToRemoveEvents;"function"==typeof s&&s();const{span:o,spanUrl:a,sendStartTime:c}=t;o&&(i._findResourceAndAddNetworkEvents(t,o,a,c,n),o.addEvent(e,r),i._addFinalSpanAttributes(o,t,a),o.end(r),i._tasksCount--),i._clearResources()}(e,n,r,s)}),300)}function t(){e(Rr.EVENT_ERROR,this)}function n(){e(Rr.EVENT_ABORT,this)}function r(){e(Rr.EVENT_TIMEOUT,this)}function s(){this.status<299?e(Rr.EVENT_LOAD,this):e(Rr.EVENT_ERROR,this)}const i=this;return e=>function(...o){const a=i._xhrMem.get(this);if(!a)return e.apply(this,o);const c=a.span,u=a.spanUrl;return c&&u&&Ut.with(zt.setSpan(Ut.active(),c),(()=>{i._tasksCount++,a.sendStartTime=j(),c.addEvent(Rr.METHOD_SEND),this.addEventListener("abort",n),this.addEventListener("error",t),this.addEventListener("load",s),this.addEventListener("timeout",r),a.callbackToRemoveEvents=()=>{!function(e){e.removeEventListener("abort",n),e.removeEventListener("error",t),e.removeEventListener("load",s),e.removeEventListener("timeout",r);const o=i._xhrMem.get(e);o&&(o.callbackToRemoveEvents=void 0)}(this),a.createdResources&&a.createdResources.observer.disconnect()},i._addHeaders(this,u),i._addResourceObserver(this,u)})),e.apply(this,o)}}enable(){this._diag.debug("applying patch to",this.moduleName,this.version),be(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),be(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())}disable(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}}!function(e){e.COMPONENT="component",e.HTTP_ERROR_NAME="http.error_name",e.HTTP_STATUS_TEXT="http.status_text"}(Pr||(Pr={}));const Cr="0.35.0";class yr extends Nr{constructor(e){super("@opentelemetry/instrumentation-fetch",Cr,e),this.component="fetch",this.version=Cr,this.moduleName=this.component,this._usedResources=new WeakSet,this._tasksCount=0}init(){}_getConfig(){return this._config}_addChildSpan(e,t){const n=this.tracer.startSpan("CORS Preflight",{startTime:t[Tr.FETCH_START]},zt.setSpan(Ut.active(),e));this._getConfig().ignoreNetworkEvents||Ee(n,t),n.end(t[Tr.RESPONSE_END])}_addFinalSpanAttributes(e,t){const n=he(t.url);e.setAttribute(Tn.HTTP_STATUS_CODE,t.status),null!=t.statusText&&e.setAttribute(Pr.HTTP_STATUS_TEXT,t.statusText),e.setAttribute(Tn.HTTP_HOST,n.host),e.setAttribute(Tn.HTTP_SCHEME,n.protocol.replace(":","")),e.setAttribute(Tn.HTTP_USER_AGENT,navigator.userAgent)}_addHeaders(e,t){if(!me(t,this._getConfig().propagateTraceHeaderCorsUrls)){const e={};return Xt.inject(Ut.active(),e),void(Object.keys(e).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(e instanceof Request)Xt.inject(Ut.active(),e.headers,{set:(e,t,n)=>e.set(t,"string"==typeof n?n:String(n))});else if(e.headers instanceof Headers)Xt.inject(Ut.active(),e.headers,{set:(e,t,n)=>e.set(t,"string"==typeof n?n:String(n))});else{const t={};Xt.inject(Ut.active(),t),e.headers=Object.assign({},t,e.headers||{})}}_clearResources(){0===this._tasksCount&&this._getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(e,t={}){if(se(e,this._getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");const n=(t.method||"GET").toUpperCase(),r=`HTTP ${n}`;return this.tracer.startSpan(r,{kind:Pt.CLIENT,attributes:{[Pr.COMPONENT]:this.moduleName,[Tn.HTTP_METHOD]:n,[Tn.HTTP_URL]:e}})}_findResourceAndAddNetworkEvents(e,t,n){let r=t.entries;if(!r.length){if(!performance.getEntriesByType)return;r=performance.getEntriesByType("resource")}const s=pe(t.spanUrl,t.startTime,n,r,this._usedResources,"fetch");if(s.mainRequest){const t=s.mainRequest;this._markResourceAsUsed(t);const n=s.corsPreFlightRequest;n&&(this._addChildSpan(e,n),this._markResourceAsUsed(n)),this._getConfig().ignoreNetworkEvents||Ee(e,t)}}_markResourceAsUsed(e){this._usedResources.add(e)}_endSpan(e,t,n){
const r=G(Date.now()),s=j();this._addFinalSpanAttributes(e,n),setTimeout((()=>{var n;null===(n=t.observer)||void 0===n||n.disconnect(),this._findResourceAndAddNetworkEvents(e,t,s),this._tasksCount--,this._clearResources(),e.end(r)}),300)}_patchConstructor(){return e=>{const t=this;return function(...n){function r(e,n){t._applyAttributesAfterFetch(e,u,n),t._endSpan(e,d,{status:n.status||0,statusText:n.message,url:c})}function s(e,n){t._applyAttributesAfterFetch(e,u,n),n.status>=200&&n.status<400?t._endSpan(e,d,n):t._endSpan(e,d,{status:n.status,statusText:n.statusText,url:c})}function i(e,t,n){try{const t=n.clone(),i=n.clone(),o=t.body;if(o){const t=o.getReader(),n=()=>{t.read().then((({done:t})=>{t?s(e,i):n()}),(t=>{r(e,t)}))};n()}else s(e,n)}finally{t(n)}}function o(e,t,n){try{r(e,n)}finally{t(n)}}const a=this,c=he(n[0]instanceof Request?n[0].url:n[0]).href,u=n[0]instanceof Request?n[0]:n[1]||{},l=t._createSpan(c,u);if(!l)return e.apply(this,n);const d=t._prepareSpanData(c);return new Promise(((n,r)=>Ut.with(zt.setSpan(Ut.active(),l),(()=>(t._addHeaders(u,c),t._tasksCount++,e.apply(a,u instanceof Request?[u]:[c,u]).then(i.bind(a,l,n),o.bind(a,l,r)))))))}}}_applyAttributesAfterFetch(e,t,n){const r=this._getConfig().applyCustomAttributesOnSpan;r&&Ne((()=>r(e,t,n)),(e=>{e&&this._diag.error("applyCustomAttributesOnSpan",e)}),!0)}_prepareSpanData(e){const t=j(),n=[];if("function"!=typeof PerformanceObserver)return{entries:n,startTime:t,spanUrl:e};const r=new PerformanceObserver((t=>{t.getEntries().forEach((t=>{"fetch"===t.initiatorType&&t.name===e&&n.push(t)}))}));return r.observe({entryTypes:["resource"]}),{entries:n,observer:r,startTime:t,spanUrl:e}}enable(){be(fetch)&&(this._unwrap(on,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(on,"fetch",this._patchConstructor())}disable(){this._unwrap(on,"fetch"),this._usedResources=new WeakSet}}const wr=(e,t,n)=>{const r=e[t];return"function"!=typeof r?r:(vr.wrap(e,t,n),Mr(e[t],r),e[t])},Mr=(e,t)=>{const n=t.toString;Object.defineProperty(e,"toString",{enumerable:!1,configurable:!0,writable:!0,value(){return n.call(this===e?t:this)}})},Dr=new WeakMap,Ur=(e,t)=>Dr.set(e,t);var xr,Br,kr,Hr,Vr,Gr,Fr,jr,Yr,Xr;const $r=new Map([[[null===(xr=globalThis.XMLHttpRequest)||void 0===xr?void 0:xr.prototype],["abort","error","load","loadend","loadstart","progress","readystatechange","timeout"]],[[null===(Br=globalThis.MessagePort)||void 0===Br?void 0:Br.prototype],["message","messageerror"]],[[null===(kr=globalThis.WebSocket)||void 0===kr?void 0:kr.prototype],["close","error","open","message"]],[[null===(Hr=globalThis.Worker)||void 0===Hr?void 0:Hr.prototype],["error","message"]],[[null===(Vr=globalThis.IDBIndex)||void 0===Vr?void 0:Vr.prototype,null===(Gr=globalThis.IDBRequest)||void 0===Gr?void 0:Gr.prototype,null===(Fr=globalThis.IDBOpenDBRequest)||void 0===Fr?void 0:Fr.prototype,null===(jr=globalThis.IDBDatabase)||void 0===jr?void 0:jr.prototype,null===(Yr=globalThis.IDBTransaction)||void 0===Yr?void 0:Yr.prototype,null===(Xr=globalThis.IDBCursor)||void 0===Xr?void 0:Xr.prototype],["abort","blocked","close","complete","error","success","upgradeneeded","versionchange"]]]),Wr=e=>{const t=new WeakMap,n=(r,s)=>{const i=Object.getOwnPropertyDescriptor(r,s);if(!i){const e=Object.getPrototypeOf(r);if(!e)return;return n(e,s)}wr(i,"get",(e=>function(){var n;const r=null==e?void 0:e.call(this);return null!==(n=t.get(r))&&void 0!==n?n:r})),wr(i,"set",(n=>function(r){let s=null;r&&(s=e.bind(e.active(),r),t.set(s,r)),n.call(this,s)})),Object.defineProperty(r,s,i)},r=new WeakMap;wr(EventTarget.prototype,"addEventListener",(t=>function(...n){const s=n[1];if(s){let t=r.get(s);t||("function"==typeof s?t=e.bind(e.active(),s):s&&"function"==typeof s.handleEvent&&(t=Object.assign(Object.assign({},s),{handleEvent:e.bind(e.active(),s.handleEvent)}))),t&&(r.set(s,t),n[1]=t)}return t.apply(this,n)})),wr(EventTarget.prototype,"removeEventListener",(e=>function(...t){const n=t[1];if(n){const e=r.get(n);e&&(t[1]=e)}return e.apply(this,t)})),$r.forEach(((e,t)=>{t.forEach((t=>{t&&((e,t)=>{t.forEach((t=>{n(e,`on${t}`)}))})(t,e)}))}))},zr=()=>{const e=(e,t)=>{t.forEach((t=>{((e,t)=>{const n=Object.getOwnPropertyDescriptor(e,t);n&&(vr.unwrap(n,"get"),vr.unwrap(n,"set"),Object.defineProperty(e,t,n))})(e,`on${t}`)}))};vr.unwrap(EventTarget.prototype,"addEventListener"),vr.unwrap(EventTarget.prototype,"removeEventListener"),$r.forEach(((t,n)=>{n.forEach((n=>{n&&e(n,t)}))}))},qr=e=>{if(!self.MessageChannel||!self.MessagePort)return;const t=new WeakMap;wr(window,"MessageChannel",(e=>class extends e{constructor(...e){super(...e),t.set(this.port1,this.port2),t.set(this.port2,this.port1)}})),wr(MessagePort.prototype,"postMessage",(n=>function(...r){const s=t.get(this);return e.active()&&s&&Ur(s,e.active()),n.apply(this,r)}))},Kr=["MutationObserver","IntersectionObserver","ResizeObserver"],Qr=e=>{Kr.forEach((t=>{globalThis[t]&&wr(globalThis,t,(n=>{const r=class extends n{constructor(...t){t[0]=e.bind(e.active(),t[0]),super(...t),setTimeout((()=>{Ur(this,Ke)}),300)}};return Object.defineProperty(r,"name",{enumerable:!1,configurable:!0,writable:!1,value:t}),Mr(r,n),r}))}))},Jr=e=>{window.Promise&&wr(window,"Promise",(t=>{const n=class extends t{};return Mr(n,t),wr(n.prototype,"then",(t=>function(...n){return n[0]=e.bind(e.active(),n[0]),n[1]=e.bind(e.active(),n[1]),t.apply(this,n)})),wr(n.prototype,"catch",(t=>function(...n){return n[0]=e.bind(e.active(),n[0]),t.apply(this,n)})),wr(n.prototype,"finally",(t=>function(...n){return n[0]=e.bind(e.active(),n[0]),t.apply(this,n)})),n}))},Zr=e=>"number"!=typeof e||e<=1500,es=e=>{wr(window,"setTimeout",(t=>function(...n){return Zr(n[1])&&(n[0]=e.bind(e.active(),n[0])),t.apply(this,n)})),wr(window,"setInterval",(t=>function(...n){return Zr(n[1])&&(n[0]=e.bind(e.active(),n[0])),t.apply(this,n)})),wr(window,"setImmediate",(t=>function(...n){return n[0]=e.bind(e.active(),n[0]),t.apply(this,n)})),wr(window,"requestAnimationFrame",(t=>function(...n){return n[0]=e.bind(e.active(),n[0]),t.apply(this,n)})),wr(window,"queueMicrotask",(t=>function(...n){return n[0]=e.bind(e.active(),n[0]),t.apply(this,n)}))},ts=e=>e?(e=>Dr.get(e))(e):void 0;class ns{constructor(){this._enabled=!1,this._currentContext=Ke}_bindFunction(e=Ke,t){const n=this,r=function(...r){var s;return n.with(null!==(s=ts(this))&&void 0!==s?s:e,(()=>t.apply(this,r)))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r}active(){return this._currentContext}bind(e=this.active(),t){return"function"==typeof t?this._bindFunction(e,t):t}disable(){return this._enabled?(vr.unwrap(window,"Promise"),vr.unwrap(window,"setTimeout"),vr.unwrap(window,"setInterval"),null!=window.setImmediate&&vr.unwrap(window,"setImmediate"),vr.unwrap(window,"requestAnimationFrame"),null!=window.queueMicrotask&&vr.unwrap(window,"queueMicrotask"),zr(),self.MessageChannel&&self.MessagePort&&(vr.unwrap(window,"MessageChannel"),vr.unwrap(MessagePort.prototype,"postMessage")),Kr.forEach((e=>{globalThis[e]&&vr.unwrap(globalThis,e)})),this._currentContext=Ke,this._enabled=!1,this):this}enable(){return this._enabled||(Jr(this),es(this),Wr(this),qr(this),Qr(this),this._enabled=!0,this._currentContext=Ke),this}with(e,t,n,...r){const s=this._currentContext;this._currentContext=null!=e?e:Ke;try{return t.apply(n,r)}finally{this._currentContext=s}}}var rs;!function(e){e.COMPONENT="component",e.DOCUMENT_LOAD="documentLoad",e.DOCUMENT_FETCH="documentFetch",e.RESOURCE_FETCH="resourceFetch",e.PAGE_TITLE="page_title"}(rs||(rs={}));var ss,is,os,as,cs,us=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},ls=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},ds=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},_s=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)},Es=function(e,t,n){var r;return function(s){t.value>=0&&(s||n)&&(t.delta=t.value-(r||0),(t.delta||void 0===r)&&(r=t.value,e(t)))}},ps=-1,hs=function(){return"hidden"===document.visibilityState?0:1/0},Ts=function(){ds((function(e){var t=e.timeStamp;ps=t}),!0)},ms=function(){return ps<0&&(ps=hs(),Ts(),_s((function(){setTimeout((function(){ps=hs(),Ts()}),0)}))),{get firstHiddenTime(){return ps}}},fs=function(e,t){var n,r=ms(),s=us("FCP"),i=function(e){"first-contentful-paint"===e.name&&(a&&a.disconnect(),e.startTime<r.firstHiddenTime&&(s.value=e.startTime,s.entries.push(e),n(!0)))},o=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],a=o?null:ls("paint",i);(o||a)&&(n=Es(e,s,t),o&&i(o),_s((function(r){s=us("FCP"),n=Es(e,s,t),requestAnimationFrame((function(){requestAnimationFrame((function(){s.value=performance.now()-r.timeStamp,n(!0)}))}))})))},gs=!1,Ss=-1,Os={passive:!0,capture:!0},Rs=new Date,vs=function(e,t){ss||(ss=t,is=e,os=new Date,bs(removeEventListener),As())},As=function(){if(is>=0&&is<os-Rs){var e={entryType:"first-input",name:ss.type,target:ss.target,cancelable:ss.cancelable,startTime:ss.timeStamp,processingStart:ss.timeStamp+is};as.forEach((function(t){t(e)})),as=[]}},Ns=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){vs(e,t),s()},r=function(){s()},s=function(){removeEventListener("pointerup",n,Os),removeEventListener("pointercancel",r,Os)};addEventListener("pointerup",n,Os),addEventListener("pointercancel",r,Os)}(t,e):vs(t,e)}},bs=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Ns,Os)}))},Ls={};!function(e){e.FIRST_PAINT="firstPaint",e.FIRST_CONTENTFUL_PAINT="firstContentfulPaint",e.LARGEST_CONTENTFUL_PAINT="largestContentfulPaint",e.CUMULATIVE_LAYOUT_SHIFT="cumulativeLayoutShift",e.FIRST_INPUT_DELAY="firstInputDelay",e.TIME_TO_FIRST_BYTE="timeToFirstByte"}(cs||(cs={}));const Ps={FCP:cs.FIRST_CONTENTFUL_PAINT,FID:cs.FIRST_INPUT_DELAY,TTFB:cs.TIME_TO_FIRST_BYTE,LCP:cs.LARGEST_CONTENTFUL_PAINT,CLS:cs.CUMULATIVE_LAYOUT_SHIFT},Is={"first-paint":cs.FIRST_PAINT},Cs=new Set([cs.CUMULATIVE_LAYOUT_SHIFT]),ys=(e,t)=>{const n={},r=new Set(["FCP","FID","TTFB"]);"chrome"in globalThis&&(r.add("LCP"),r.add("CLS"));let s=!1;const i=()=>{var r,o;if(document.removeEventListener("visibilitychange",i),globalThis.removeEventListener("pagehide",i),!s){const i=null===(o=(r=hn).getEntriesByType)||void 0===o?void 0:o.call(r,"paint");i&&i.forEach((({name:e,startTime:t})=>{de(Is,e)&&(n[Is[e]]=new Date(F()+t))})),s=!0,Object.entries(n).forEach((([t,n])=>{Cs.has(t)?e.setAttribute(t,n.getTime()):e.addEvent(t,n)})),t()}},o=e=>{r.delete(e.name),n[Ps[e.name]]=new Date(F()+e.value),r.size||i()};if(document.addEventListener("visibilitychange",i),globalThis.addEventListener("pagehide",i),function(e,t){gs||(fs((function(e){Ss=e.value})),gs=!0);var n,r=function(t){Ss>-1&&e(t)},s=us("CLS",0),i=0,o=[],a=function(e){if(!e.hadRecentInput){var t=o[0],r=o[o.length-1];i&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,o.push(e)):(i=e.value,o=[e]),i>s.value&&(s.value=i,s.entries=o,n())}},c=ls("layout-shift",a);c&&(n=Es(r,s,t),ds((function(){c.takeRecords().map(a),n(!0)})),_s((function(){i=0,Ss=-1,s=us("CLS",0),n=Es(r,s,t)})))}(o),fs(o),function(e,t){var n,r=ms(),s=us("FID"),i=function(e){e.startTime<r.firstHiddenTime&&(s.value=e.processingStart-e.startTime,s.entries.push(e),n(!0))},o=ls("first-input",i);n=Es(e,s,t),o&&ds((function(){o.takeRecords().map(i),o.disconnect()}),!0),o&&_s((function(){var r;s=us("FID"),n=Es(e,s,t),as=[],is=-1,ss=null,bs(addEventListener),r=i,as.push(r),As()}))}(o),function(e,t){var n,r=ms(),s=us("LCP"),i=function(e){var t=e.startTime;t<r.firstHiddenTime&&(s.value=t,s.entries.push(e),n())},o=ls("largest-contentful-paint",i);if(o){n=Es(e,s,t);var a=function(){Ls[s.id]||(o.takeRecords().map(i),o.disconnect(),Ls[s.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,a,{once:!0,capture:!0})})),ds(a,!0),_s((function(r){s=us("LCP"),n=Es(e,s,t),requestAnimationFrame((function(){requestAnimationFrame((function(){s.value=performance.now()-r.timeStamp,Ls[s.id]=!0,n(!0)}))}))}))}}(o),function(e){var t,n=us("TTFB");t=function(){try{var t=performance.getEntriesByType("navigation")[0]||function(){var e=performance.timing,t={entryType:"navigation",startTime:0};for(var n in e)"navigationStart"!==n&&"toJSON"!==n&&(t[n]=Math.max(e[n]-e.navigationStart,0));return t}();if(n.value=n.delta=t.responseStart,n.value<0||n.value>performance.now())return;n.entries=[t],e(n)}catch(e){}},"complete"===document.readyState?setTimeout(t,0):addEventListener("load",(function(){return setTimeout(t,0)}))}(o),"function"==typeof PerformanceObserver){const e=new PerformanceObserver((()=>{}));if(e.observe({type:"largest-contentful-paint",buffered:!0}),"function"==typeof e.takeRecords){const[t]=e.takeRecords();t&&(r.delete("LCP"),n[cs.LARGEST_CONTENTFUL_PAINT]=new Date(F()+t.startTime))}}};class ws extends Nr{constructor(e={}){super("@opentelemetry/instrumentation-document-load","0.31.0",e),this.component="document-load",this.version="1",this.moduleName=this.component,this._enabled=!1}init(){}_onDocumentLoaded(){window.setTimeout((()=>{this._collectPerformance()}))}_addResourcesSpans(e){var t,n;const r=null===(n=(t=hn).getEntriesByType)||void 0===n?void 0:n.call(t,"resource");r&&r.forEach((t=>{this._initResourceSpan(t,e)}))}_collectPerformance(){const e=Array.from(document.getElementsByTagName("meta")).find((e=>e.getAttribute("name")===wn)),t=(()=>{var e,t;const n={},r=null===(t=(e=hn).getEntriesByType)||void 0===t?void 0:t.call(e,"navigation")[0];if(r)Object.values(Tr).forEach((e=>{if(de(r,e)){const t=r[e];"number"==typeof t&&(n[e]=t)}}));else{const e=hn.timing;e&&Object.values(Tr).forEach((t=>{if(de(e,t)){const r=e[t];"number"==typeof r&&(n[t]=r)}}))}return n})(),n=this._getRootSpanEndTime(t),r=e&&e.content||"";Ut.with(Xt.extract(Ke,{traceparent:r}),(()=>{const e=this._startSpan(rs.DOCUMENT_LOAD,Tr.FETCH_START,t);e&&(Ut.with(zt.setSpan(Ut.active(),e),(()=>{const e=this._startSpan(rs.DOCUMENT_FETCH,Tr.FETCH_START,t);e&&(e.setAttribute(Tn.HTTP_URL,location.href),e.setAttribute(Tn.HTTP_USER_AGENT,navigator.userAgent),Ut.with(zt.setSpan(Ut.active(),e),(()=>{Ee(e,t),this._endSpan(e,Tr.RESPONSE_END,t)})))})),e.setAttribute(Tn.HTTP_URL,location.href),e.setAttribute(Tn.HTTP_USER_AGENT,navigator.userAgent),e.setAttribute(rs.PAGE_TITLE,document.title),this._addResourcesSpans(e),_e(e,Tr.FETCH_START,t),_e(e,Tr.UNLOAD_EVENT_START,t),_e(e,Tr.UNLOAD_EVENT_END,t),_e(e,Tr.DOM_INTERACTIVE,t),_e(e,Tr.DOM_CONTENT_LOADED_EVENT_START,t),_e(e,Tr.DOM_CONTENT_LOADED_EVENT_END,t),_e(e,Tr.DOM_COMPLETE,t),_e(e,Tr.LOAD_EVENT_START,t),_e(e,Tr.LOAD_EVENT_END,t),ys(e,(()=>{n?e.end(n):(xt.warn("loadEventEnd event not present in performance entries."),e.end())})))}))}_getRootSpanEndTime(e){const t=e[Tr.LOAD_EVENT_END];return"number"!=typeof t?null:new Date(F()+t)}_endSpan(e,t,n){e&&(de(n,t)?e.end(n[t]):e.end())}_initResourceSpan(e,t){const n=this._startSpan(rs.RESOURCE_FETCH,Tr.FETCH_START,e,t);n&&(n.setAttribute(Tn.HTTP_URL,e.name),Ee(n,e),this._endSpan(n,Tr.RESPONSE_END,e))}_startSpan(e,t,n,r){if(de(n,t)&&"number"==typeof n[t]){const s=this.tracer.startSpan(e,{startTime:n[t]},r?zt.setSpan(Ut.active(),r):void 0);return s.setAttribute(rs.COMPONENT,this.component),s}}_waitForPageLoad(){"complete"!==window.document.readyState||this._enabled?(this._onDocumentLoaded=this._onDocumentLoaded.bind(this),window.addEventListener("load",this._onDocumentLoaded)):(this._enabled=!0,this._onDocumentLoaded())}enable(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()}disable(){window.removeEventListener("load",this._onDocumentLoaded)}}var Ms;!function(e){e.COMPONENT="component",e.EVENT_TYPE="event_type",e.TARGET_ELEMENT="target_element",e.TARGET_XPATH="target_xpath",e.HTTP_URL="http.url",e.HTTP_USER_AGENT="http.user_agent"}(Ms||(Ms={}));const Ds="0.32.0",Us=["click"],xs=()=>`${location.pathname}${location.search}${location.hash}`;class Bs extends Nr{constructor(e){var t;super("@opentelemetry/instrumentation-user-interaction",Ds,e),this.component="user-interaction",this.version=Ds,this.moduleName=this.component,this._spansData=new WeakMap,this._isEnabled=!1,this._wrappedListeners=new WeakMap,this._eventsSpanMap=new WeakMap,this._eventNames=new Set(null!==(t=null==e?void 0:e.eventNames)&&void 0!==t?t:Us),this._shouldPreventSpanCreation="function"==typeof(null==e?void 0:e.shouldPreventSpanCreation)?e.shouldPreventSpanCreation:Le}init(){}_allowEventName(e){return this._eventNames.has(e)}_createSpan(e,t){if(!(e instanceof HTMLElement))return;if(!e.getAttribute)return;if(e.hasAttribute("disabled"))return;if(!this._allowEventName(t))return;const n=Te(e,!0);try{const r=this.tracer.startSpan(t,{attributes:{[Ms.COMPONENT]:this.component,[Ms.EVENT_TYPE]:t,[Ms.TARGET_ELEMENT]:e.tagName,[Ms.TARGET_XPATH]:n,[Ms.HTTP_URL]:window.location.href,[Ms.HTTP_USER_AGENT]:navigator.userAgent}},Ke);if(!0===this._shouldPreventSpanCreation(t,e,r))return;return this._spansData.set(r,{taskCount:0}),r}catch(e){xt.error(this.component,e)}}addPatchedListener(e,t,n,r){let s=this._wrappedListeners.get(n);s||(s=new Map,this._wrappedListeners.set(n,s));let i=s.get(t);return i||(i=new Map,s.set(t,i)),!i.has(e)&&(i.set(e,r),!0)}removePatchedListener(e,t,n){const r=this._wrappedListeners.get(n);if(!r)return;const s=r.get(t);if(!s)return;const i=s.get(e);return i&&(s.delete(e),0===s.size&&(r.delete(t),0===r.size&&this._wrappedListeners.delete(n))),i}_invokeListener(e,t,n){return"function"==typeof e?e.apply(t,n):e.handleEvent(n[0])}_patchAddEventListener(){const e=this;return t=>function(n,r,s){if(!r)return t.call(this,n,r,s);const i=s&&"object"==typeof s&&s.once,o=this,a=function(...t){const s=t[0],a=null==s?void 0:s.target;i&&e.removePatchedListener(o,n,r);const c=s&&e._eventsSpanMap.get(s),u=c||e._createSpan(a,n);if(u){s&&!c&&e._eventsSpanMap.set(s,u);const n=e._spansData.get(u),i=Ut.with(zt.setSpan(Ut.active(),u),(()=>{void 0===n.currentLocation&&(n.currentLocation=xs());const s=e._invokeListener(r,this,t);return n.lastListenerEndHrTime=j(),s}));return s&&!c&&setTimeout((()=>{n.currentLocation!==xs()&&e._updateSpanAsNavigation(u),u.end(n.lastListenerEndHrTime)}),200),i}return s instanceof UIEvent&&s.isTrusted?Ut.with(Ke,(()=>e._invokeListener(r,this,t))):e._invokeListener(r,this,t)};return e.addPatchedListener(this,n,r,a)?t.call(this,n,a,s):void 0}}_patchRemoveEventListener(){const e=this;return t=>function(n,r,s){const i=e.removePatchedListener(this,n,r);return i?t.call(this,n,i,s):t.call(this,n,r,s)}}_getPatchableEventTargets(){return window.EventTarget?[EventTarget.prototype]:[Node.prototype,Window.prototype]}_updateSpanAsNavigation(e){e.updateName(`Navigation: ${xs()}`),e.setAttribute("new.location.href",location.href)}enable(){this._isEnabled||(this._isEnabled=!0,xt.debug("applying patch to",this.moduleName,this.version),this._getPatchableEventTargets().forEach((e=>{this._wrap(e,"addEventListener",this._patchAddEventListener()),this._wrap(e,"removeEventListener",this._patchRemoveEventListener())})))}disable(){this._isEnabled&&(this._isEnabled=!1,xt.debug("removing patch from",this.moduleName,this.version),this._getPatchableEventTargets().forEach((e=>{be(e.addEventListener)&&this._unwrap(e,"addEventListener"),be(e.removeEventListener)&&this._unwrap(e,"removeEventListener")})))}}const ks=1e4;class Hs{constructor(e={}){this._sendingPromises=[],this.url=this.getDefaultUrl(e),"string"==typeof e.hostname&&(this.hostname=e.hostname),this.shutdown=this.shutdown.bind(this),this._shutdownOnce=new Qn(this._shutdown,this),this._concurrencyLimit="number"==typeof e.concurrencyLimit?e.concurrencyLimit:1/0,this.timeoutMillis=Pe(e.timeoutMillis),this.onInit(e)}export(e,t){this._shutdownOnce.isCalled?t({code:Nn.FAILED,error:new Error("Exporter has been shutdown")}):this._sendingPromises.length>=this._concurrencyLimit?t({code:Nn.FAILED,error:new Error("Concurrent export limit reached")}):this._export(e).then((()=>{t({code:Nn.SUCCESS})})).catch((e=>{t({code:Nn.FAILED,error:e})}))}_export(e){return new Promise(((t,n)=>{try{xt.debug("items to be sent",e),this.send(e,t,n)}catch(e){n(e)}}))}shutdown(){return this._shutdownOnce.call()}_shutdown(){return xt.debug("shutdown started"),this.onShutdown(),Promise.all(this._sendingPromises).then((()=>{}))}}class Vs extends Error{constructor(e,t,n){super(e),this.name="OTLPExporterError",this.data=n,this.code=t}}let Gs=1/0;class Fs extends Hs{constructor(e={}){super(e),this._useXHR=!1,this._useXHR=!!e.headers||"function"!=typeof navigator.sendBeacon,this._useXHR?this._headers=Object.assign({},function(e={}){const t={};return Object.entries(e).forEach((([e,n])=>{void 0!==n?t[e]=String(n):xt.warn(`Header "${e}" has wrong value and will be ignored`)})),t}(e.headers),A(k().OTEL_EXPORTER_OTLP_HEADERS)):this._headers={}}onInit(){window.addEventListener("unload",this.shutdown)}onShutdown(){window.removeEventListener("unload",this.shutdown)}send(e,t,n){if(this._shutdownOnce.isCalled)return void xt.debug("Shutdown already started. Cannot send objects");const r=this.convert(e),s=JSON.stringify(r),i=new Promise(((e,t)=>{!this._useXHR&&function(e,t){const n=new Blob([e],{type:"application/json"});return n.size<Gs&&navigator.sendBeacon(t,n)?(xt.debug("sendBeacon - can send",e),!0):(Gs=n.size,xt.info("sendBeacon failed because the given payload was too big; try to lower your span processor limits"),!1)}(s,this.url)?e():function(e,t,n,r,s,i){let o;const a=setTimeout((()=>{o=!0,c.abort()}),r),c=new XMLHttpRequest;c.open("POST",t),Object.entries(Object.assign(Object.assign({},{Accept:"application/json","Content-Type":"application/json"}),n)).forEach((([e,t])=>{c.setRequestHeader(e,t)})),c.send(e),c.onreadystatechange=()=>{if(c.readyState===XMLHttpRequest.DONE)if(c.status>=200&&c.status<=299)clearTimeout(a),xt.debug("xhr success",e),s();else if(o){const e=new Vs("Request Timeout",c.status);i(e)}else{const e=new Vs(`Failed to export with XHR (status: ${c.status})`,c.status);clearTimeout(a),i(e)}}}(s,this.url,this._headers,this.timeoutMillis,e,t)})).then(t,n);this._sendingPromises.push(i);const o=()=>{const e=this._sendingPromises.indexOf(i);this._sendingPromises.splice(e,1)};i.then(o,o)}}var js,Ys,Xs,$s,Ws;!function(e){e[e.SPAN_KIND_UNSPECIFIED=0]="SPAN_KIND_UNSPECIFIED",e[e.SPAN_KIND_INTERNAL=1]="SPAN_KIND_INTERNAL",e[e.SPAN_KIND_SERVER=2]="SPAN_KIND_SERVER",e[e.SPAN_KIND_CLIENT=3]="SPAN_KIND_CLIENT",e[e.SPAN_KIND_PRODUCER=4]="SPAN_KIND_PRODUCER",e[e.SPAN_KIND_CONSUMER=5]="SPAN_KIND_CONSUMER"}(js||(js={})),function(e){e[e.DELTA=0]="DELTA",e[e.CUMULATIVE=1]="CUMULATIVE"}(Ys||(Ys={})),function(e){e[e.HISTOGRAM=0]="HISTOGRAM",e[e.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",e[e.GAUGE=2]="GAUGE",e[e.SUM=3]="SUM"}(Xs||(Xs={})),function(e){e[e.DROP=0]="DROP",e[e.SUM=1]="SUM",e[e.LAST_VALUE=2]="LAST_VALUE",e[e.HISTOGRAM=3]="HISTOGRAM"}($s||($s={})),function(e){e.COUNTER="COUNTER",e.HISTOGRAM="HISTOGRAM",e.UP_DOWN_COUNTER="UP_DOWN_COUNTER",e.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",e.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",e.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"}(Ws||(Ws={}));const zs="v1/traces",qs=`http://localhost:4318/${zs}`;class Ks extends Fs{constructor(e={}){super(e),this._headers=Object.assign(this._headers,A(k().OTEL_EXPORTER_OTLP_TRACES_HEADERS))}convert(e){return function(e){return{resourceSpans:Ue(e,!0)}}(e)}getDefaultUrl(e){return"string"==typeof e.url?e.url:k().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length>0?function(e){try{const t=new URL(e);return""===t.pathname&&(t.pathname=t.pathname+"/"),t.toString()}catch(t){return xt.warn(`Could not parse export URL: '${e}'`),e}}(k().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT):k().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?(t=k().OTEL_EXPORTER_OTLP_ENDPOINT,n=zs,t.endsWith("/")||(t+="/"),t+n):qs;var t,n}}class Qs{constructor(e){this._exporter=e}export(e,t){const n=(r=j(),Math.round(1e3*r[0]+r[1]/1e6));var r;e.forEach((e=>{e.resource.attributes["sumologic.telemetry.sdk.export_timestamp"]=n})),this._exporter.export(e,t)}shutdown(){return le(this,void 0,void 0,(function*(){return this._exporter.shutdown()}))}}const Js=["click","dblclick","submit","reset","pause","play","dragstart","dragend","drop"],Zs="root_span.operation",ei="root_span.http.url",ti="xhr.is_root_span",ni="http.action_type",ri="object"==typeof window&&null!=window,si="object"==typeof document&&null!=document,ii=e=>e.name.startsWith("HTTP ")&&e.kind===Pt.CLIENT,oi=e=>{var t;if(e)return"documentLoad"===(t=e).name&&"@opentelemetry/instrumentation-document-load"===t.instrumentationLibrary.name?"document_loads":e.attributes[ti]?(e=>e.name.startsWith("Navigation: ")&&"@opentelemetry/instrumentation-user-interaction"===e.instrumentationLibrary.name)(e)?"route_changes":"xhr_requests":void 0},ai=e=>e.attributes["new.location.href"]||e.attributes["location.href"],ci="document.visibilityState",ui={visible:"pageshow",hidden:"pagehide"},li=[];let di=si?null===document||void 0===document?void 0:document.visibilityState:null,_i=di;const Ei=()=>{const e=null===document||void 0===document?void 0:document.visibilityState;if(_i!==e){_i=e;const t=j();li.push({timestampInNanoseconds:X(t),timestampInHrTime:t,state:e}),li.length>100&&li.shift()}};si&&ri&&(null===document||void 0===document||document.addEventListener("visibilitychange",(()=>{Ei()})),null===window||void 0===window||window.addEventListener("pagehide",(()=>{Ei()})),null===window||void 0===window||window.addEventListener("pageshow",(()=>{Ei()})));const pi=1e7;let hi=[],Ti=[];const mi=(e,t,n)=>e+pi>=t&&e-pi<=n,fi=(e,t)=>{e.parentSpanId=t.spanContext().spanId,e.spanContext().traceId=t.spanContext().traceId},gi=(e,t)=>{if("@opentelemetry/instrumentation-long-task"===e.instrumentationLibrary.name){if(!e.parentSpanId){const t=(e=>{const t=X(e);for(let e=hi.length-1;e>=0;e-=1){const n=hi[e];if(mi(t,X(n.startTime),X(n.endTime)))return n}})(e.startTime);if(!t)return Ti.push(e),void(Ti.length>10&&Ti.shift());fi(e,t)}}else hi.push(e),hi.length>100&&hi.shift(),((e,t)=>{const n=X(e.startTime),r=X(e.endTime);for(let s=Ti.length-1;s>=0;s-=1){const i=Ti[s];mi(X(i.startTime),n,r)&&(Ti.splice(s,1),fi(i,e),t(i))}})(e,t);t(e)},Si={},Oi=[],Ri=new WeakMap,vi=e=>Si[e.spanContext().traceId],Ai=e=>e.name.startsWith("HTTP ")&&e.kind===Pt.CLIENT,Ni=e=>"@opentelemetry/instrumentation-long-task"===e.instrumentationLibrary.name,bi=(e,t)=>{const n=ai(t);if(e.attributes[Zs]=t.name,n&&(e.attributes[ei]=n),Ni(e)){const n=oi(t);n&&(e.attributes[ni]=n)}};var Li;!function(e){e[e.DROP_ROOT_SPAN=0]="DROP_ROOT_SPAN"}(Li||(Li={}));const Pi=[(e,t,n)=>{if(n.shouldDropSingleUserInteractionTraces&&"@opentelemetry/instrumentation-user-interaction"===e.instrumentationLibrary.name&&1===t.length)return Li.DROP_ROOT_SPAN},(e,t)=>{const n=t.filter((e=>"@opentelemetry/instrumentation-long-task"===e.instrumentationLibrary.name&&"longtask"===e.name));if(n.length>0){const t=n.map((e=>X(e.duration))).reduce(((e,t)=>e+t),0);e.attributes["http.longtasks_sum"]=t}},(e,t)=>{const n=t.filter(ii).sort(((e,t)=>X(e.startTime)-X(t.startTime)));if(!n.length)return;const[r]=n,s=n[n.length-1];e.attributes["http.time_to_first_xhr"]=X(r.startTime)-X(e.startTime),e.attributes["http.time_to_last_xhr"]=X(s.endTime)-X(e.startTime);const i=Math.max(...t.map((e=>X(e.endTime))));e.attributes["http.time_to_xhr_processing_end"]=i-X(e.startTime);const o=[];n.forEach((e=>{const t=X(e.startTime),n=X(e.endTime),r=o[o.length-1];!r||t>r[1]?o.push([t,n]):n>r[1]&&(r[1]=n)})),e.attributes["http.time_in_xhr_calls"]=o.reduce(((e,[t,n])=>e+(n-t)),0)}],Ii={},Ci="sumoLogicOpenTelemetryRumSessionId",yi=({sessionId:e,lastActivityTimestamp:t})=>{document.cookie=`${Ci}=${e}-${t}; path=/`},wi=new class{constructor(){this.generateTraceId=V(16),this.generateSpanId=V(8)}};let Mi;si&&(Mi=(()=>{const e=document.cookie.split("; ").find((e=>e.startsWith(`${Ci}=`)));if(!e)return;const[t,n]=e.split("=")[1].split("-");return{sessionId:t,lastActivityTimestamp:parseInt(n,10)}})());const Di=()=>{const e=Date.now();if(Mi){const t=e-Mi.lastActivityTimestamp;t>3e5?Mi=void 0:t>3e4&&(Mi.lastActivityTimestamp=e,yi(Mi))}return Mi||(Mi={sessionId:wi.generateTraceId(),lastActivityTimestamp:e},yi(Mi)),Mi.sessionId};class Ui extends cr{constructor(e,t){var n,r;super(e,t),this.shouldCollectSessionId=null===(n=t.collectSessionId)||void 0===n||n,this.shouldDropSingleUserInteractionTraces=null===(r=t.dropSingleUserInteractionTraces)||void 0===r||r,this.getOverriddenServiceName=t.getOverriddenServiceName,this.defaultServiceName=t.defaultServiceName,this.traceProcessor=(e=>{const t=()=>{Object.values(Ii).forEach((e=>{n(e)}))};document.addEventListener("visibilitychange",(()=>{t()})),window.addEventListener("pagehide",(()=>{t()}));const n=({traceId:t,rootSpan:n,send:r,spans:s})=>{if(delete Ii[t],!n||!r)return;let i=!0;Pi.forEach((t=>{t(n,s,e)===Li.DROP_ROOT_SPAN&&(i=!1)})),i&&r()},r=e=>{clearTimeout(e.timeout),e.timeout=setTimeout((()=>{n(e)}),3e4)};return{onStart:e=>{const t=e.spanContext().traceId;let n=Ii[t];n||(n={traceId:t,timeout:-1,spans:[]},Ii[t]=n),e.parentSpanId||n.rootSpan||(n.rootSpan=e),r(n)},onEnd:(e,t)=>{let n=!0;const s=e,i=s.spanContext().traceId,o=Ii[i];o&&(o.spans.push(s),o.rootSpan===s&&(n=!1,o.send=()=>{t(e)}),r(o)),n&&t(e)}}})(this)}onStart(e,t=Ke){(e=>{if(!si||null===di)return;e.setAttribute(ci,di);const t=X(e.startTime);for(let n=li.length-1;n>=0;n-=1){const{timestampInNanoseconds:r,state:s}=li[n];if(r<=t){e.setAttribute(ci,s);break}}})(e),(e=>{const{parentSpanId:t}=e;if(Ai(e)&&t){const t=vi(e);t&&(t.attributes[ti]=!0)}if(!t){const{traceId:t}=e.spanContext();if(Si[t]=e,Oi.push(t),Oi.length>50){const e=Oi.shift();delete Si[e]}}})(e),this.traceProcessor.onStart(e,t),this.shouldCollectSessionId&&(e=>{si&&e.setAttribute("rum.session_id",Di())})(e),((e,t,n)=>{var r;const s=null===(r=null==n?void 0:n.getOverriddenServiceName)||void 0===r?void 0:r.call(n,e);void 0!==s&&(e.setAttribute(fn,s),e.setAttribute("default.service.name",n.defaultServiceName))})(e,0,{getOverriddenServiceName:this.getOverriddenServiceName,defaultServiceName:this.defaultServiceName}),e.setAttribute("location.href",location.href),super.onStart(e,t)}onEnd(e){(e=>{const t=e,n=X(t.startTime),r=e.parentSpanId?X(t.endTime):1/0;for(let e=li.length-1;e>=0;e-=1){const{timestampInNanoseconds:s,timestampInHrTime:i,state:o}=li[e];if(s<n)break;s>=n&&s<=r&&(t.events.push({name:ui[o],attributes:void 0,time:i}),"hidden"===o&&(t.attributes[ci]=o))}})(e),gi(e,(e=>{(e=>{const t=e,n=Ri.get(t);n&&n.forEach((e=>bi(e,t)));const r=Ai(t),s=Ni(t);if(e.parentSpanId&&(r||s)){const e=vi(t);if(e&&(bi(t,e),!e.ended)){const n=Ri.get(e);n?n.push(t):Ri.set(e,[t])}}})(e),this.traceProcessor.onEnd(e,(e=>{super.onEnd(e)}))}))}}const xi="0.32.0",Bi="longtask";class ki extends Nr{constructor(e={}){super("@opentelemetry/instrumentation-long-task",xi,e),this.component="long-task",this.version=xi,this.moduleName=this.component}init(){}isSupported(){return!("undefined"==typeof PerformanceObserver||!PerformanceObserver.supportedEntryTypes)&&PerformanceObserver.supportedEntryTypes.includes(Bi)}_createSpanFromEntry(e){const t=this.tracer.startSpan(Bi,{startTime:j(e.startTime)});if(this._config.observerCallback)try{this._config.observerCallback(t,{longtaskEntry:e})}catch(e){xt.error("longtask instrumentation: observer callback failed",e)}t.setAttribute("component",this.component),t.setAttribute("http.url",location.href),t.setAttribute("longtask.name",e.name),t.setAttribute("longtask.entry_type",e.entryType),t.setAttribute("longtask.duration",e.duration),Array.isArray(e.attribution)&&e.attribution.forEach(((n,r)=>{const s=e.attribution.length>1?`longtask.attribution[${r}]`:"longtask.attribution";t.setAttribute(`${s}.name`,n.name),t.setAttribute(`${s}.entry_type`,n.entryType),t.setAttribute(`${s}.start_time`,n.startTime),t.setAttribute(`${s}.duration`,n.duration),t.setAttribute(`${s}.container_type`,n.containerType),t.setAttribute(`${s}.container_src`,n.containerSrc),t.setAttribute(`${s}.container_id`,n.containerId),t.setAttribute(`${s}.container_name`,n.containerName)})),t.end(j(e.startTime+e.duration))}enable(){this.isSupported()?this._observer||(this._observer=new PerformanceObserver((e=>{
e.getEntries().forEach((e=>this._createSpanFromEntry(e)))})),this._observer.observe({type:Bi,buffered:!0})):this._diag.debug("Environment not supported")}disable(){this._observer&&(this._observer.disconnect(),this._observer=void 0)}}var Hi,Vi="4.4.0";!function(e){e[e.SEVERITY_NUMBER_UNSPECIFIED=0]="SEVERITY_NUMBER_UNSPECIFIED",e[e.SEVERITY_NUMBER_TRACE=1]="SEVERITY_NUMBER_TRACE",e[e.SEVERITY_NUMBER_TRACE2=2]="SEVERITY_NUMBER_TRACE2",e[e.SEVERITY_NUMBER_TRACE3=3]="SEVERITY_NUMBER_TRACE3",e[e.SEVERITY_NUMBER_TRACE4=4]="SEVERITY_NUMBER_TRACE4",e[e.SEVERITY_NUMBER_DEBUG=5]="SEVERITY_NUMBER_DEBUG",e[e.SEVERITY_NUMBER_DEBUG2=6]="SEVERITY_NUMBER_DEBUG2",e[e.SEVERITY_NUMBER_DEBUG3=7]="SEVERITY_NUMBER_DEBUG3",e[e.SEVERITY_NUMBER_DEBUG4=8]="SEVERITY_NUMBER_DEBUG4",e[e.SEVERITY_NUMBER_INFO=9]="SEVERITY_NUMBER_INFO",e[e.SEVERITY_NUMBER_INFO2=10]="SEVERITY_NUMBER_INFO2",e[e.SEVERITY_NUMBER_INFO3=11]="SEVERITY_NUMBER_INFO3",e[e.SEVERITY_NUMBER_INFO4=12]="SEVERITY_NUMBER_INFO4",e[e.SEVERITY_NUMBER_WARN=13]="SEVERITY_NUMBER_WARN",e[e.SEVERITY_NUMBER_WARN2=14]="SEVERITY_NUMBER_WARN2",e[e.SEVERITY_NUMBER_WARN3=15]="SEVERITY_NUMBER_WARN3",e[e.SEVERITY_NUMBER_WARN4=16]="SEVERITY_NUMBER_WARN4",e[e.SEVERITY_NUMBER_ERROR=17]="SEVERITY_NUMBER_ERROR",e[e.SEVERITY_NUMBER_ERROR2=18]="SEVERITY_NUMBER_ERROR2",e[e.SEVERITY_NUMBER_ERROR3=19]="SEVERITY_NUMBER_ERROR3",e[e.SEVERITY_NUMBER_ERROR4=20]="SEVERITY_NUMBER_ERROR4",e[e.SEVERITY_NUMBER_FATAL=21]="SEVERITY_NUMBER_FATAL",e[e.SEVERITY_NUMBER_FATAL2=22]="SEVERITY_NUMBER_FATAL2",e[e.SEVERITY_NUMBER_FATAL3=23]="SEVERITY_NUMBER_FATAL3",e[e.SEVERITY_NUMBER_FATAL4=24]="SEVERITY_NUMBER_FATAL4"}(Hi||(Hi={}));const Gi=e=>{switch(typeof e){case"number":return Number.isInteger(e)?{intValue:e}:{doubleValue:e};case"boolean":return{boolValue:e};case"object":if(Array.isArray(e))return{arrayValue:{values:e.map((e=>Gi(e)))}};if(null!=e)return{kvlistValue:{values:Object.entries(e).map((([e,t])=>Fi(e,t)))}};default:return{stringValue:String(e)}}},Fi=(e,t)=>({key:e,value:Gi(t)}),ji=e=>Object.entries(e).map((([e,t])=>Fi(e,t)));let Yi=1/0;class Xi{constructor({resource:e,attributes:t,collectorUrl:n,maxQueueSize:r,scheduledDelayMillis:s}){this.onVisibilityChange=()=>{"hidden"===document.visibilityState&&this.export()},this.onPageHide=()=>{this.export()},this.recordCustomError=(e,t)=>{this.recordLog({type:"customError",message:e,attributes:t})},this.resource=e,this.defaultAttributes=t,this.collectorUrl=n,this.maxQueueSize=r,this.scheduledDelayMillis=s,this.logs=[]}enable(){null!=document&&(this.disable(),document.addEventListener("visibilitychange",this.onVisibilityChange),document.addEventListener("pagehide",this.onPageHide))}disable(){document.removeEventListener("visibilitychange",this.onVisibilityChange),document.removeEventListener("pagehide",this.onPageHide)}exportWhenNeeded(){this.logs.length>=this.maxQueueSize?this.export():void 0===this.timer&&(this.timer=Number(setTimeout((()=>this.export()),this.scheduledDelayMillis)))}recordLog(e){var t;const n=[...ji(this.defaultAttributes),Fi("type",e.type),Fi("http.url",location.href)],r=zt.getSpan(Ut.active());if(r&&(e=>"name"in e&&"instrumentationLibrary"in e)(r)){const e=null===(t=(e=>{const t=Ii[e];if(t){const{rootSpan:e,spans:n}=t;return{rootSpan:e,spans:n}}})(r.spanContext().traceId))||void 0===t?void 0:t.rootSpan;if(e){n.push(Fi(Zs,e.name));const t=ai(e);t&&n.push(Fi(ei,t));const r=oi(e);r&&n.push(Fi(ni,r))}}e.element&&n.push(Fi("element.xpath",e.element.xpath)),e.error&&(n.push(Fi("error.name",e.error.name)),n.push(Fi("error.message",e.error.message)),e.error.stack&&n.push(Fi("error.stack",e.error.stack))),e.arguments&&n.push(Fi("arguments",e.arguments)),e.attributes&&Object.entries(e.attributes).forEach((([e,t])=>{n.push(Fi(e,t))})),this.logs.push({timeUnixNano:X(j()),severityNumber:Hi.SEVERITY_NUMBER_ERROR,body:{stringValue:e.message},attributes:n,droppedAttributesCount:0,traceId:null==r?void 0:r.spanContext().traceId,spanId:null==r?void 0:r.spanContext().spanId}),this.exportWhenNeeded()}export(){clearTimeout(this.timer),this.timer=void 0;const{logs:e}=this;if(!e.length)return;this.logs=[];const t=JSON.stringify({resourceLogs:[{resource:{attributes:ji(this.resource.attributes)},instrumentationLibraryLogs:[{instrumentationLibrary:{name:"@sumologic/opentelemetry-rum",version:Vi},logs:e}]}]});((e,t)=>{const n=new Blob([t],{type:"application/json"});(n.size>=Yi||!navigator.sendBeacon(e,n))&&(Yi=n.size,fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:t}))})(this.collectorUrl,t)}}const $i=(e,t)=>e.length>t?`${e.slice(0,t)}...`:e,Wi=e=>e instanceof Error?{name:e.name,message:e.message,stack:e.stack?$i(e.stack,5e3):void 0}:void 0,zi=(e,t=0)=>{if("string"==typeof e){const n=$i(e,500);return t>0?`"${n}"`:n}return Array.isArray(e)?t>0?"...":`[${e.map((e=>zi(e,t+1))).join(", ")}]`:e instanceof Error?zi({name:e.name,message:e.message},t):null!=e&&"object"==typeof e?t>0?"...":`{ ${Object.getOwnPropertyNames(e).map((n=>`${n}: ${zi(e[n],t+1)}`)).join(", ")} }`:String(e)},qi=(e,t=new Set)=>{const n=!t.has(e);if(t.add(e),Array.isArray(e))return e.map((e=>qi(e,t)));if(null!=e&&"object"==typeof e){const r={};return Object.getOwnPropertyNames(e).forEach((s=>{const i=e[s];r[s]=t.has(i)&&(i!==e||n)?"[Circular]":qi(i)})),r}return e};class Ki{constructor({exporter:e}){this.isEnabled=!1,this.onError=e=>{this.exporter.recordLog({type:"uncaughtException",message:e.message,error:Wi(e.error)})},this.onUnhandledRejection=({reason:e})=>{if(!e)return;const t=Wi(e);this.exporter.recordLog({type:"unhandledRejection",message:t?`Unhandled rejection ${e}`:String(e),error:t})},this.onDocumentError=({target:e})=>{if(!e)return;const t=Te(e);t&&this.exporter.recordLog({type:"documentError",message:`Uncaught error in element ${t}`,element:{xpath:t}})},this.onConsoleError=e=>{const t=e.find(Wi),n=e.length>3||e.find((e=>null!=e&&"object"==typeof e&&!(e instanceof Error)))?e.map((e=>qi(e))):void 0;this.exporter.recordLog({type:"consoleError",message:e.map((e=>zi(e))).join(" "),arguments:n,error:t})},this.exporter=e;const t=console.error;console.error=(...e)=>{this.isEnabled&&this.onConsoleError(e),t.apply(console,e)}}enable(){this.disable(),window.addEventListener("error",this.onError),window.addEventListener("unhandledrejection",this.onUnhandledRejection),document.documentElement.addEventListener("error",this.onDocumentError,{capture:!0}),this.isEnabled=!0}disable(){window.removeEventListener("error",this.onError),window.removeEventListener("unhandledrejection",this.onUnhandledRejection),document.documentElement.removeEventListener("error",this.onDocumentError,{capture:!0}),this.isEnabled=!1}}const Qi=e=>"number"==typeof e?e:null!=e&&Number.isFinite(+e)?+e:void 0;var Ji;const Zi="object"==typeof window&&null!=window;let eo;Zi&&(window.sumoLogicOpenTelemetryRum=window.sumoLogicOpenTelemetryRum||{},eo=new ns,eo.enable());const to=({collectionSourceUrl:e,authorizationToken:t,serviceName:n,applicationName:r,deploymentEnvironment:s,defaultAttributes:i,samplingProbability:o=1,bufferMaxSpans:a=2048,maxExportBatchSize:c=50,bufferTimeout:u=2e3,ignoreUrls:l=[],propagateTraceHeaderCorsUrls:d=[],collectSessionId:_,dropSingleUserInteractionTraces:E,collectErrors:p=!0,userInteractionElementNameLimit:h=20,getOverriddenServiceName:T})=>{var m;if(!Zi)return;if(!e)throw new Error("collectionSourceUrl needs to be defined to initialize Sumo Logic OpenTelemetry RUM");const f=null!==(m=Qi(o))&&void 0!==m?m:1,g=null!=n?n:"unknown",S={[fn]:g,"sumologic.rum.version":Vi};r&&(S.application=r),s&&(S[mn]=s);const O=new _r(S),R=O.merge(new _r(Object.assign(Object.assign({},i),{"sampling.probability":f}))),v=new gr({resource:R,sampler:new rr(f)}),A=new bn({propagators:[new Un,new nn]});v.register({contextManager:eo,propagator:A});const N=Object.assign({},i),b=(e=>{const t=new URL(e);return t.pathname=t.pathname.replace(/\/v1\/(traces|metrics|logs)\/?$/,""),t.pathname.endsWith("/")||(t.pathname+="/"),t.href})(e),L=new Ks({url:`${b}v1/traces`,headers:t?{Authorization:t}:void 0}),P=new Qs(L);v.addSpanProcessor(new Ui(P,{maxQueueSize:a,maxExportBatchSize:c,scheduledDelayMillis:u,collectSessionId:_,dropSingleUserInteractionTraces:E,getOverriddenServiceName:T,defaultServiceName:g}));const I=O.merge(new _r({[Tn.HTTP_USER_AGENT]:navigator.userAgent})),C=new Xi({resource:I,attributes:N,collectorUrl:`${b}v1/logs`,maxQueueSize:a,scheduledDelayMillis:u}),y=p?new Ki({exporter:C}):void 0;let w;const M=()=>{w&&(w(),null==y||y.disable(),C.disable(),w=void 0)},D=()=>{M(),C.enable(),null==y||y.enable(),w=ge({tracerProvider:v,instrumentations:[new ki({enabled:!1}),new ws({enabled:!1}),new Bs({enabled:!1,eventNames:Js,shouldPreventSpanCreation:(e,t,n)=>{const r=((e,t,n)=>{var r;let s="",i=t;for(;i&&!s;)s=i.getAttribute("aria-label")||i.id||i.textContent||"",s=s.trim(),i=i.parentElement;if(s){const t=null!==(r=Qi(n))&&void 0!==r?r:20;return t>0&&s.length>t&&(s=`${s.slice(0,t-3)}...`),`${e} on '${s}'`}})(e,t,h);return r&&n.updateName(r),!1}}),new Ir({enabled:!1,propagateTraceHeaderCorsUrls:d,ignoreUrls:[e,...l]}),new yr({enabled:!1,propagateTraceHeaderCorsUrls:d,ignoreUrls:l})]})},U=v.getTracer("@sumologic/opentelemetry-rum");D();const x={readyListeners:[],onReady:e=>{e()},api:Kt,tracer:U,registerInstrumentations:D,disableInstrumentations:M,setDefaultAttribute:(e,t)=>{v.resource.attributes[e]=t,N[e]=t},getCurrentSessionId:Di,recordError:C.recordCustomError};return Zi&&Object.assign(window.sumoLogicOpenTelemetryRum,x),x};if(Zi){window.sumoLogicOpenTelemetryRum.initialize=to;const e=null===(Ji=window.sumoLogicOpenTelemetryRum)||void 0===Ji?void 0:Ji.readyListeners;Array.isArray(e)&&e.forEach((e=>e()))}const no=e=>{if(e)try{return JSON.parse(e)}catch(e){return}},ro=e=>{var t;return null===(t=no(e)||(e=>{if("string"==typeof e)return e.split(",").map((e=>e.trim()))})(e))||void 0===t?void 0:t.map((e=>new RegExp(e)))};if("object"==typeof document&&null!=document&&document.currentScript&&document.currentScript.dataset.collectionSourceUrl){const{collectionSourceUrl:e,authorizationToken:t,serviceName:n,applicationName:r,defaultAttributes:s,samplingProbability:i,bufferMaxSpans:o,bufferTimeout:a,ignoreUrls:c,propagateTraceHeaderCorsUrls:u}=document.currentScript.dataset;window.opentelemetry=to({collectionSourceUrl:e,authorizationToken:t,serviceName:n,applicationName:r,defaultAttributes:no(s),samplingProbability:Qi(i),bufferMaxSpans:Qi(o),bufferTimeout:Qi(a),ignoreUrls:ro(c),propagateTraceHeaderCorsUrls:ro(u)||[/.*/]})}e.initialize=to,Object.defineProperty(e,"__esModule",{value:!0})}({});